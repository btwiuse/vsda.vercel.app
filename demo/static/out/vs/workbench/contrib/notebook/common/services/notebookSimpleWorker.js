/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/(function(){var ne=["require","exports","vs/base/common/strings","vs/base/common/platform","vs/base/common/path","vs/base/common/lifecycle","vs/base/common/buffer","vs/base/common/extpath","vs/base/common/network","vs/base/common/uri","vs/editor/common/model/pieceTreeTextBuffer/pieceTreeBase","vs/editor/common/core/range","vs/base/common/mime","vs/base/common/stream","vs/base/common/errors","vs/base/common/map","vs/base/common/resources","vs/base/common/async","vs/base/common/event","vs/base/common/glob","vs/editor/common/core/eolCounter","vs/editor/common/core/stringBuilder","vs/editor/common/core/textChange","vs/editor/common/model/pieceTreeTextBuffer/rbTreeBase","vs/editor/common/model","vs/editor/common/model/pieceTreeTextBuffer/pieceTreeTextBuffer","vs/editor/common/model/pieceTreeTextBuffer/pieceTreeTextBufferBuilder","vs/platform/instantiation/common/instantiation","vs/platform/contextkey/common/contextkey","vs/workbench/contrib/notebook/common/notebookCommon","vs/base/common/arrays","vs/base/common/types","vs/base/common/cancellation","vs/editor/common/core/position","vs/editor/common/model/textModelSearch","vs/base/common/iterator","vs/workbench/contrib/notebook/common/services/notebookSimpleWorker","vs/base/common/diff/diff","vs/base/common/hash"],ie=function(Z){for(var e=[],O=0,F=Z.length;O<F;O++)e[O]=ne[Z[O]];return e};define(ne[12],ie([0,1,4]),function(Z,e,O){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeMimeType=e.getExtensionForMimeType=e.getMediaMime=e.getMediaOrTextMime=e.Mimes=void 0;var F;(function(T){T.text="text/plain",T.binary="application/octet-stream",T.unknown="application/unknown",T.markdown="text/markdown",T.latex="text/latex",T.uriList="text/uri-list"})(F=e.Mimes||(e.Mimes={}));const D={".css":"text/css",".csv":"text/csv",".htm":"text/html",".html":"text/html",".ics":"text/calendar",".js":"text/javascript",".mjs":"text/javascript",".txt":"text/plain",".xml":"text/xml"},E={".aac":"audio/x-aac",".avi":"video/x-msvideo",".bmp":"image/bmp",".flv":"video/x-flv",".gif":"image/gif",".ico":"image/x-icon",".jpe":"image/jpg",".jpeg":"image/jpg",".jpg":"image/jpg",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3a":"audio/mpeg",".mid":"audio/midi",".midi":"audio/midi",".mk3d":"video/x-matroska",".mks":"video/x-matroska",".mkv":"video/x-matroska",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp2a":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4a":"audio/mp4",".mp4v":"video/mp4",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpg4":"video/mp4",".mpga":"audio/mpeg",".oga":"audio/ogg",".ogg":"audio/ogg",".opus":"audio/opus",".ogv":"video/ogg",".png":"image/png",".psd":"image/vnd.adobe.photoshop",".qt":"video/quicktime",".spx":"audio/ogg",".svg":"image/svg+xml",".tga":"image/x-tga",".tif":"image/tiff",".tiff":"image/tiff",".wav":"audio/x-wav",".webm":"video/webm",".webp":"image/webp",".wma":"audio/x-ms-wma",".wmv":"video/x-ms-wmv",".woff":"application/font-woff"};function q(T){const _=(0,O.extname)(T),N=D[_.toLowerCase()];return N!==void 0?N:k(T)}e.getMediaOrTextMime=q;function k(T){const _=(0,O.extname)(T);return E[_.toLowerCase()]}e.getMediaMime=k;function A(T){for(const _ in E)if(E[_]===T)return _}e.getExtensionForMimeType=A;const w=/^(.+)\/(.+?)(;.+)?$/;function S(T,_){const N=w.exec(T);return N?`${N[1].toLowerCase()}/${N[2].toLowerCase()}${N[3]??""}`:_?void 0:T}e.normalizeMimeType=S}),define(ne[13],ie([0,1,14,5]),function(Z,e,O,F){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.prefixedStream=e.prefixedReadable=e.transform=e.toReadable=e.emptyStream=e.toStream=e.peekStream=e.listenStream=e.consumeStream=e.peekReadable=e.consumeReadable=e.newWriteableStream=e.isReadableBufferedStream=e.isReadableStream=e.isReadable=void 0;function D(u){const f=u;return f?typeof f.read=="function":!1}e.isReadable=D;function E(u){const f=u;return f?[f.on,f.pause,f.resume,f.destroy].every(g=>typeof g=="function"):!1}e.isReadableStream=E;function q(u){const f=u;return f?E(f.stream)&&Array.isArray(f.buffer)&&typeof f.ended=="boolean":!1}e.isReadableBufferedStream=q;function k(u,f){return new A(u,f)}e.newWriteableStream=k;class A{constructor(f,g){this.reducer=f,this.options=g,this.state={flowing:!1,ended:!1,destroyed:!1},this.buffer={data:[],error:[]},this.listeners={data:[],error:[],end:[]},this.pendingWritePromises=[]}pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(f){if(!this.state.destroyed){if(this.state.flowing)this.emitData(f);else if(this.buffer.data.push(f),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(g=>this.pendingWritePromises.push(g))}}error(f){this.state.destroyed||(this.state.flowing?this.emitError(f):this.buffer.error.push(f))}end(f){this.state.destroyed||(typeof f!="undefined"&&this.write(f),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(f){this.listeners.data.slice(0).forEach(g=>g(f))}emitError(f){this.listeners.error.length===0?(0,O.onUnexpectedError)(f):this.listeners.error.slice(0).forEach(g=>g(f))}emitEnd(){this.listeners.end.slice(0).forEach(f=>f())}on(f,g){if(!this.state.destroyed)switch(f){case"data":this.listeners.data.push(g),this.resume();break;case"end":this.listeners.end.push(g),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(g),this.state.flowing&&this.flowErrors();break}}removeListener(f,g){if(this.state.destroyed)return;let C;switch(f){case"data":C=this.listeners.data;break;case"end":C=this.listeners.end;break;case"error":C=this.listeners.error;break}if(C){const I=C.indexOf(g);I>=0&&C.splice(I,1)}}flowData(){if(this.buffer.data.length>0){const f=this.reducer(this.buffer.data);this.emitData(f),this.buffer.data.length=0;const g=[...this.pendingWritePromises];this.pendingWritePromises.length=0,g.forEach(C=>C())}}flowErrors(){if(this.listeners.error.length>0){for(const f of this.buffer.error)this.emitError(f);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}}function w(u,f){const g=[];let C;for(;(C=u.read())!==null;)g.push(C);return f(g)}e.consumeReadable=w;function S(u,f,g){const C=[];let I;for(;(I=u.read())!==null&&C.length<g;)C.push(I);return I===null&&C.length>0?f(C):{read:()=>{if(C.length>0)return C.shift();if(typeof I!="undefined"){const M=I;return I=void 0,M}return u.read()}}}e.peekReadable=S;function T(u,f){return new Promise((g,C)=>{const I=[];_(u,{onData:M=>{f&&I.push(M)},onError:M=>{f?C(M):g(void 0)},onEnd:()=>{g(f?f(I):void 0)}})})}e.consumeStream=T;function _(u,f){let g=!1;return u.on("error",C=>{g||f.onError(C)}),u.on("end",()=>{g||f.onEnd()}),u.on("data",C=>{g||f.onData(C)}),(0,F.toDisposable)(()=>g=!0)}e.listenStream=_;function N(u,f){return new Promise((g,C)=>{const I=new F.DisposableStore,M=[],a=l=>{if(M.push(l),M.length>f)return I.dispose(),u.pause(),g({stream:u,buffer:M,ended:!1})},i=l=>C(l),h=()=>g({stream:u,buffer:M,ended:!0});I.add((0,F.toDisposable)(()=>u.removeListener("error",i))),u.on("error",i),I.add((0,F.toDisposable)(()=>u.removeListener("end",h))),u.on("end",h),I.add((0,F.toDisposable)(()=>u.removeListener("data",a))),u.on("data",a)})}e.peekStream=N;function b(u,f){const g=k(f);return g.end(u),g}e.toStream=b;function c(){const u=k(()=>{throw new Error("not supported")});return u.end(),u}e.emptyStream=c;function o(u){let f=!1;return{read:()=>f?null:(f=!0,u)}}e.toReadable=o;function t(u,f,g){const C=k(g);return _(u,{onData:I=>C.write(f.data(I)),onError:I=>C.error(f.error?f.error(I):I),onEnd:()=>C.end()}),C}e.transform=t;function s(u,f,g){let C=!1;return{read:()=>{const I=f.read();return C?I:(C=!0,I!==null?g([u,I]):u)}}}e.prefixedReadable=s;function r(u,f,g){let C=!1;const I=k(g);return _(f,{onData:M=>C?I.write(M):(C=!0,I.write(g([u,M]))),onError:M=>I.error(M),onEnd:()=>{C||(C=!0,I.write(u)),I.end()}}),I}e.prefixedStream=r}),define(ne[6],ie([0,1,13]),function(Z,e,O){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.encodeBase64=e.decodeBase64=e.prefixedBufferStream=e.prefixedBufferReadable=e.newWriteableBufferStream=e.streamToBufferReadableStream=e.bufferToStream=e.bufferedStreamToBuffer=e.streamToBuffer=e.bufferToReadable=e.readableToBuffer=e.writeUInt8=e.readUInt8=e.writeUInt32LE=e.readUInt32LE=e.writeUInt32BE=e.readUInt32BE=e.writeUInt16LE=e.readUInt16LE=e.VSBuffer=void 0;const F=typeof Buffer!="undefined";let D,E;class q{constructor(l){this.buffer=l,this.byteLength=this.buffer.byteLength}static alloc(l){return F?new q(Buffer.allocUnsafe(l)):new q(new Uint8Array(l))}static wrap(l){return F&&!Buffer.isBuffer(l)&&(l=Buffer.from(l.buffer,l.byteOffset,l.byteLength)),new q(l)}static fromString(l,d){return!(d?.dontUseNodeBuffer||!1)&&F?new q(Buffer.from(l)):(D||(D=new TextEncoder),new q(D.encode(l)))}static fromByteArray(l){const d=q.alloc(l.length);for(let L=0,U=l.length;L<U;L++)d.buffer[L]=l[L];return d}static concat(l,d){if(typeof d=="undefined"){d=0;for(let z=0,P=l.length;z<P;z++)d+=l[z].byteLength}const L=q.alloc(d);let U=0;for(let z=0,P=l.length;z<P;z++){const n=l[z];L.set(n,U),U+=n.byteLength}return L}clone(){const l=q.alloc(this.byteLength);return l.set(this),l}toString(){return F?this.buffer.toString():(E||(E=new TextDecoder),E.decode(this.buffer))}slice(l,d){return new q(this.buffer.subarray(l,d))}set(l,d){if(l instanceof q)this.buffer.set(l.buffer,d);else if(l instanceof Uint8Array)this.buffer.set(l,d);else if(l instanceof ArrayBuffer)this.buffer.set(new Uint8Array(l),d);else if(ArrayBuffer.isView(l))this.buffer.set(new Uint8Array(l.buffer,l.byteOffset,l.byteLength),d);else throw new Error("Unknown argument 'array'")}readUInt32BE(l){return w(this.buffer,l)}writeUInt32BE(l,d){S(this.buffer,l,d)}readUInt32LE(l){return T(this.buffer,l)}writeUInt32LE(l,d){_(this.buffer,l,d)}readUInt8(l){return N(this.buffer,l)}writeUInt8(l,d){b(this.buffer,l,d)}}e.VSBuffer=q;function k(h,l){return h[l+0]<<0>>>0|h[l+1]<<8>>>0}e.readUInt16LE=k;function A(h,l,d){h[d+0]=l&255,l=l>>>8,h[d+1]=l&255}e.writeUInt16LE=A;function w(h,l){return h[l]*2**24+h[l+1]*2**16+h[l+2]*2**8+h[l+3]}e.readUInt32BE=w;function S(h,l,d){h[d+3]=l,l=l>>>8,h[d+2]=l,l=l>>>8,h[d+1]=l,l=l>>>8,h[d]=l}e.writeUInt32BE=S;function T(h,l){return h[l+0]<<0>>>0|h[l+1]<<8>>>0|h[l+2]<<16>>>0|h[l+3]<<24>>>0}e.readUInt32LE=T;function _(h,l,d){h[d+0]=l&255,l=l>>>8,h[d+1]=l&255,l=l>>>8,h[d+2]=l&255,l=l>>>8,h[d+3]=l&255}e.writeUInt32LE=_;function N(h,l){return h[l]}e.readUInt8=N;function b(h,l,d){h[d]=l}e.writeUInt8=b;function c(h){return O.consumeReadable(h,l=>q.concat(l))}e.readableToBuffer=c;function o(h){return O.toReadable(h)}e.bufferToReadable=o;function t(h){return O.consumeStream(h,l=>q.concat(l))}e.streamToBuffer=t;async function s(h){return h.ended?q.concat(h.buffer):q.concat([...h.buffer,await t(h.stream)])}e.bufferedStreamToBuffer=s;function r(h){return O.toStream(h,l=>q.concat(l))}e.bufferToStream=r;function u(h){return O.transform(h,{data:l=>typeof l=="string"?q.fromString(l):q.wrap(l)},l=>q.concat(l))}e.streamToBufferReadableStream=u;function f(h){return O.newWriteableStream(l=>q.concat(l),h)}e.newWriteableBufferStream=f;function g(h,l){return O.prefixedReadable(h,l,d=>q.concat(d))}e.prefixedBufferReadable=g;function C(h,l){return O.prefixedStream(h,l,d=>q.concat(d))}e.prefixedBufferStream=C;function I(h){let l=0,d=0,L=0;const U=new Uint8Array(Math.floor(h.length/4*3)),z=n=>{switch(d){case 3:U[L++]=l|n,d=0;break;case 2:U[L++]=l|n>>>2,l=n<<6,d=3;break;case 1:U[L++]=l|n>>>4,l=n<<4,d=2;break;default:l=n<<2,d=1}};for(let n=0;n<h.length;n++){const p=h.charCodeAt(n);if(p>=65&&p<=90)z(p-65);else if(p>=97&&p<=122)z(p-97+26);else if(p>=48&&p<=57)z(p-48+52);else if(p===43||p===45)z(62);else if(p===47||p===95)z(63);else{if(p===61)break;throw new SyntaxError(`Unexpected base64 character ${h[n]}`)}}const P=L;for(;d>0;)z(0);return q.wrap(U).slice(0,P)}e.decodeBase64=I;const M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function i({buffer:h},l=!0,d=!1){const L=d?a:M;let U="";const z=h.byteLength%3;let P=0;for(;P<h.byteLength-z;P+=3){const n=h[P+0],p=h[P+1],v=h[P+2];U+=L[n>>>2],U+=L[(n<<4|p>>>4)&63],U+=L[(p<<2|v>>>6)&63],U+=L[v&63]}if(z===1){const n=h[P+0];U+=L[n>>>2],U+=L[n<<4&63],l&&(U+="==")}else if(z===2){const n=h[P+0],p=h[P+1];U+=L[n>>>2],U+=L[(n<<4|p>>>4)&63],U+=L[p<<2&63],l&&(U+="=")}return U}e.encodeBase64=i});var ae=this&&this.__classPrivateFieldSet||function(Z,e,O,F,D){if(F==="m")throw new TypeError("Private method is not writable");if(F==="a"&&!D)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?Z!==e||!D:!e.has(Z))throw new TypeError("Cannot write private member to an object whose class did not declare it");return F==="a"?D.call(Z,O):D?D.value=O:e.set(Z,O),O},re=this&&this.__classPrivateFieldGet||function(Z,e,O,F){if(O==="a"&&!F)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?Z!==e||!F:!e.has(Z))throw new TypeError("Cannot read private member from an object whose class did not declare it");return O==="m"?F:O==="a"?F.call(Z):F?F.value:e.get(Z)};define(ne[15],ie([0,1,30,2]),function(Z,e,O,F){"use strict";var D,E,q,k;Object.defineProperty(e,"__esModule",{value:!0}),e.ReadonlyMapView=e.LRUCache=e.LinkedMap=e.Touch=e.ResourceSet=e.ResourceMap=e.TernarySearchTree=e.UriIterator=e.PathIterator=e.ConfigKeysIterator=e.StringIterator=e.setToString=e.mapToString=e.getOrSet=void 0;function A(a,i,h){let l=a.get(i);return l===void 0&&(l=h,a.set(i,l)),l}e.getOrSet=A;function w(a){const i=[];return a.forEach((h,l)=>{i.push(`${l} => ${h}`)}),`Map(${a.size}) {${i.join(", ")}}`}e.mapToString=w;function S(a){const i=[];return a.forEach(h=>{i.push(h)}),`Set(${a.size}) {${i.join(", ")}}`}e.setToString=S;class T{constructor(){this._value="",this._pos=0}reset(i){return this._value=i,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(i){const h=i.charCodeAt(0),l=this._value.charCodeAt(this._pos);return h-l}value(){return this._value[this._pos]}}e.StringIterator=T;class _{constructor(i=!0){this._caseSensitive=i}reset(i){return this._value=i,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let i=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(i)this._from++;else break;else i=!1;return this}cmp(i){return this._caseSensitive?(0,F.compareSubstring)(i,this._value,0,i.length,this._from,this._to):(0,F.compareSubstringIgnoreCase)(i,this._value,0,i.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}e.ConfigKeysIterator=_;class N{constructor(i=!0,h=!0){this._splitOnBackslash=i,this._caseSensitive=h}reset(i){this._from=0,this._to=0,this._value=i,this._valueLen=i.length;for(let h=i.length-1;h>=0;h--,this._valueLen--){const l=this._value.charCodeAt(h);if(!(l===47||this._splitOnBackslash&&l===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let i=!0;for(;this._to<this._valueLen;this._to++){const h=this._value.charCodeAt(this._to);if(h===47||this._splitOnBackslash&&h===92)if(i)this._from++;else break;else i=!1}return this}cmp(i){return this._caseSensitive?(0,F.compareSubstring)(i,this._value,0,i.length,this._from,this._to):(0,F.compareSubstringIgnoreCase)(i,this._value,0,i.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}e.PathIterator=N;var b;(function(a){a[a.Scheme=1]="Scheme",a[a.Authority=2]="Authority",a[a.Path=3]="Path",a[a.Query=4]="Query",a[a.Fragment=5]="Fragment"})(b||(b={}));class c{constructor(i,h){this._ignorePathCasing=i,this._ignoreQueryAndFragment=h,this._states=[],this._stateIdx=0}reset(i){return this._value=i,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new N(!1,!this._ignorePathCasing(i)),this._pathIterator.reset(i.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(i)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(i){if(this._states[this._stateIdx]===1)return(0,F.compareIgnoreCase)(i,this._value.scheme);if(this._states[this._stateIdx]===2)return(0,F.compareIgnoreCase)(i,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(i);if(this._states[this._stateIdx]===4)return(0,F.compare)(i,this._value.query);if(this._states[this._stateIdx]===5)return(0,F.compare)(i,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}e.UriIterator=c;class o{constructor(){this.height=1}isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){const i=this.right;return this.right=i.left,i.left=this,this.updateHeight(),i.updateHeight(),i}rotateRight(){const i=this.left;return this.left=i.right,i.right=this,this.updateHeight(),i.updateHeight(),i}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}}var t;(function(a){a[a.Left=-1]="Left",a[a.Mid=0]="Mid",a[a.Right=1]="Right"})(t||(t={}));class s{constructor(i){this._iter=i}static forUris(i=()=>!1,h=()=>!1){return new s(new c(i,h))}static forPaths(i=!1){return new s(new N(void 0,!i))}static forStrings(){return new s(new T)}static forConfigKeys(){return new s(new _)}clear(){this._root=void 0}fill(i,h){if(h){const l=h.slice(0);(0,O.shuffle)(l);for(let d of l)this.set(d,i)}else{const l=i.slice(0);(0,O.shuffle)(l);for(let d of l)this.set(d[0],d[1])}}set(i,h){const l=this._iter.reset(i);let d;this._root||(this._root=new o,this._root.segment=l.value());const L=[];for(d=this._root;;){const z=l.cmp(d.segment);if(z>0)d.left||(d.left=new o,d.left.segment=l.value()),L.push([-1,d]),d=d.left;else if(z<0)d.right||(d.right=new o,d.right.segment=l.value()),L.push([1,d]),d=d.right;else if(l.hasNext())l.next(),d.mid||(d.mid=new o,d.mid.segment=l.value()),L.push([0,d]),d=d.mid;else break}const U=d.value;d.value=h,d.key=i;for(let z=L.length-1;z>=0;z--){const P=L[z][1];P.updateHeight();const n=P.balanceFactor();if(n<-1||n>1){const p=L[z][0],v=L[z+1][0];if(p===1&&v===1)L[z][1]=P.rotateLeft();else if(p===-1&&v===-1)L[z][1]=P.rotateRight();else if(p===1&&v===-1)P.right=L[z+1][1]=L[z+1][1].rotateRight(),L[z][1]=P.rotateLeft();else if(p===-1&&v===1)P.left=L[z+1][1]=L[z+1][1].rotateLeft(),L[z][1]=P.rotateRight();else throw new Error;if(z>0)switch(L[z-1][0]){case-1:L[z-1][1].left=L[z][1];break;case 1:L[z-1][1].right=L[z][1];break;case 0:L[z-1][1].mid=L[z][1];break}else this._root=L[0][1]}}return U}get(i){return this._getNode(i)?.value}_getNode(i){const h=this._iter.reset(i);let l=this._root;for(;l;){const d=h.cmp(l.segment);if(d>0)l=l.left;else if(d<0)l=l.right;else if(h.hasNext())h.next(),l=l.mid;else break}return l}has(i){const h=this._getNode(i);return!(h?.value===void 0&&h?.mid===void 0)}delete(i){return this._delete(i,!1)}deleteSuperstr(i){return this._delete(i,!0)}_delete(i,h){const l=this._iter.reset(i),d=[];let L=this._root;for(;L;){const U=l.cmp(L.segment);if(U>0)d.push([-1,L]),L=L.left;else if(U<0)d.push([1,L]),L=L.right;else if(l.hasNext())l.next(),d.push([0,L]),L=L.mid;else break}if(!!L){if(h?(L.left=void 0,L.mid=void 0,L.right=void 0,L.height=1):(L.key=void 0,L.value=void 0),!L.mid&&!L.value)if(L.left&&L.right){const U=this._min(L.right),{key:z,value:P,segment:n}=U;this._delete(U.key,!1),L.key=z,L.value=P,L.segment=n}else{const U=L.left??L.right;if(d.length>0){const[z,P]=d[d.length-1];switch(z){case-1:P.left=U;break;case 0:P.mid=U;break;case 1:P.right=U;break}}else this._root=U}for(let U=d.length-1;U>=0;U--){const z=d[U][1];z.updateHeight();const P=z.balanceFactor();if(P>1?(z.right.balanceFactor()>=0||(z.right=z.right.rotateRight()),d[U][1]=z.rotateLeft()):P<-1&&(z.left.balanceFactor()<=0||(z.left=z.left.rotateLeft()),d[U][1]=z.rotateRight()),U>0)switch(d[U-1][0]){case-1:d[U-1][1].left=d[U][1];break;case 1:d[U-1][1].right=d[U][1];break;case 0:d[U-1][1].mid=d[U][1];break}else this._root=d[0][1]}}}_min(i){for(;i.left;)i=i.left;return i}findSubstr(i){const h=this._iter.reset(i);let l=this._root,d;for(;l;){const L=h.cmp(l.segment);if(L>0)l=l.left;else if(L<0)l=l.right;else if(h.hasNext())h.next(),d=l.value||d,l=l.mid;else break}return l&&l.value||d}findSuperstr(i){const h=this._iter.reset(i);let l=this._root;for(;l;){const d=h.cmp(l.segment);if(d>0)l=l.left;else if(d<0)l=l.right;else if(h.hasNext())h.next(),l=l.mid;else return l.mid?this._entries(l.mid):void 0}}forEach(i){for(const[h,l]of this)i(l,h)}*[Symbol.iterator](){yield*this._entries(this._root)}*_entries(i){!i||(i.left&&(yield*this._entries(i.left)),i.value&&(yield[i.key,i.value]),i.mid&&(yield*this._entries(i.mid)),i.right&&(yield*this._entries(i.right)))}_isBalanced(){const i=h=>{if(!h)return!0;const l=h.balanceFactor();return l<-1||l>1?!1:i(h.left)&&i(h.right)};return i(this._root)}}e.TernarySearchTree=s;class r{constructor(i,h){this.uri=i,this.value=h}}class u{constructor(i,h){this[D]="ResourceMap",i instanceof u?(this.map=new Map(i.map),this.toKey=h??u.defaultToKey):(this.map=new Map,this.toKey=i??u.defaultToKey)}set(i,h){return this.map.set(this.toKey(i),new r(i,h)),this}get(i){return this.map.get(this.toKey(i))?.value}has(i){return this.map.has(this.toKey(i))}get size(){return this.map.size}clear(){this.map.clear()}delete(i){return this.map.delete(this.toKey(i))}forEach(i,h){typeof h!="undefined"&&(i=i.bind(h));for(let[l,d]of this.map)i(d.value,d.uri,this)}*values(){for(let i of this.map.values())yield i.value}*keys(){for(let i of this.map.values())yield i.uri}*entries(){for(let i of this.map.values())yield[i.uri,i.value]}*[(D=Symbol.toStringTag,Symbol.iterator)](){for(let[,i]of this.map)yield[i.uri,i.value]}}e.ResourceMap=u,u.defaultToKey=a=>a.toString();class f{constructor(i,h){this[E]="ResourceSet",!i||typeof i=="function"?this._map=new u(i):(this._map=new u(h),i.forEach(this.add,this))}get size(){return this._map.size}add(i){return this._map.set(i,i),this}clear(){this._map.clear()}delete(i){return this._map.delete(i)}forEach(i,h){this._map.forEach((l,d)=>i.call(h,d,d,this))}has(i){return this._map.has(i)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(E=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}e.ResourceSet=f;var g;(function(a){a[a.None=0]="None",a[a.AsOld=1]="AsOld",a[a.AsNew=2]="AsNew"})(g=e.Touch||(e.Touch={}));class C{constructor(){this[q]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(i){return this._map.has(i)}get(i,h=0){const l=this._map.get(i);if(!!l)return h!==0&&this.touch(l,h),l.value}set(i,h,l=0){let d=this._map.get(i);if(d)d.value=h,l!==0&&this.touch(d,l);else{switch(d={key:i,value:h,next:void 0,previous:void 0},l){case 0:this.addItemLast(d);break;case 1:this.addItemFirst(d);break;case 2:this.addItemLast(d);break;default:this.addItemLast(d);break}this._map.set(i,d),this._size++}return this}delete(i){return!!this.remove(i)}remove(i){const h=this._map.get(i);if(!!h)return this._map.delete(i),this.removeItem(h),this._size--,h.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const i=this._head;return this._map.delete(i.key),this.removeItem(i),this._size--,i.value}forEach(i,h){const l=this._state;let d=this._head;for(;d;){if(h?i.bind(h)(d.value,d.key,this):i(d.value,d.key,this),this._state!==l)throw new Error("LinkedMap got modified during iteration.");d=d.next}}keys(){const i=this,h=this._state;let l=this._head;const d={[Symbol.iterator](){return d},next(){if(i._state!==h)throw new Error("LinkedMap got modified during iteration.");if(l){const L={value:l.key,done:!1};return l=l.next,L}else return{value:void 0,done:!0}}};return d}values(){const i=this,h=this._state;let l=this._head;const d={[Symbol.iterator](){return d},next(){if(i._state!==h)throw new Error("LinkedMap got modified during iteration.");if(l){const L={value:l.value,done:!1};return l=l.next,L}else return{value:void 0,done:!0}}};return d}entries(){const i=this,h=this._state;let l=this._head;const d={[Symbol.iterator](){return d},next(){if(i._state!==h)throw new Error("LinkedMap got modified during iteration.");if(l){const L={value:[l.key,l.value],done:!1};return l=l.next,L}else return{value:void 0,done:!0}}};return d}[(q=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(i){if(i>=this.size)return;if(i===0){this.clear();return}let h=this._head,l=this.size;for(;h&&l>i;)this._map.delete(h.key),h=h.next,l--;this._head=h,this._size=l,h&&(h.previous=void 0),this._state++}addItemFirst(i){if(!this._head&&!this._tail)this._tail=i;else if(this._head)i.next=this._head,this._head.previous=i;else throw new Error("Invalid list");this._head=i,this._state++}addItemLast(i){if(!this._head&&!this._tail)this._head=i;else if(this._tail)i.previous=this._tail,this._tail.next=i;else throw new Error("Invalid list");this._tail=i,this._state++}removeItem(i){if(i===this._head&&i===this._tail)this._head=void 0,this._tail=void 0;else if(i===this._head){if(!i.next)throw new Error("Invalid list");i.next.previous=void 0,this._head=i.next}else if(i===this._tail){if(!i.previous)throw new Error("Invalid list");i.previous.next=void 0,this._tail=i.previous}else{const h=i.next,l=i.previous;if(!h||!l)throw new Error("Invalid list");h.previous=l,l.next=h}i.next=void 0,i.previous=void 0,this._state++}touch(i,h){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(h!==1&&h!==2)){if(h===1){if(i===this._head)return;const l=i.next,d=i.previous;i===this._tail?(d.next=void 0,this._tail=d):(l.previous=d,d.next=l),i.previous=void 0,i.next=this._head,this._head.previous=i,this._head=i,this._state++}else if(h===2){if(i===this._tail)return;const l=i.next,d=i.previous;i===this._head?(l.previous=void 0,this._head=l):(l.previous=d,d.next=l),i.next=void 0,i.previous=this._tail,this._tail.next=i,this._tail=i,this._state++}}}toJSON(){const i=[];return this.forEach((h,l)=>{i.push([l,h])}),i}fromJSON(i){this.clear();for(const[h,l]of i)this.set(h,l)}}e.LinkedMap=C;class I extends C{constructor(i,h=1){super();this._limit=i,this._ratio=Math.min(Math.max(0,h),1)}get limit(){return this._limit}set limit(i){this._limit=i,this.checkTrim()}get ratio(){return this._ratio}set ratio(i){this._ratio=Math.min(Math.max(0,i),1),this.checkTrim()}get(i,h=2){return super.get(i,h)}peek(i){return super.get(i,0)}set(i,h){return super.set(i,h,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}e.LRUCache=I;class M{constructor(i){k.set(this,void 0),ae(this,k,i,"f")}get size(){return re(this,k,"f").size}forEach(i,h){re(this,k,"f").forEach(i,h)}get(i){return re(this,k,"f").get(i)}has(i){return re(this,k,"f").has(i)}entries(){return re(this,k,"f").entries()}keys(){return re(this,k,"f").keys()}values(){return re(this,k,"f").values()}[(k=new WeakMap,Symbol.iterator)](){return re(this,k,"f").entries()}}e.ReadonlyMapView=M}),define(ne[7],ie([0,1,4,3,2,31]),function(Z,e,O,F,D,E){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomPath=e.parseLineAndColumnAware=e.indexOfPath=e.getDriveLetter=e.hasDriveLetter=e.isRootOrDriveLetter=e.sanitizeFilePath=e.isWindowsDriveLetter=e.isEqualOrParent=e.isEqual=e.isValidBasename=e.isUNC=e.getRoot=e.toPosixPath=e.toSlashes=e.isPathSeparator=void 0;function q(a){return a===47||a===92}e.isPathSeparator=q;function k(a){return a.replace(/[\\/]/g,O.posix.sep)}e.toSlashes=k;function A(a){return a.indexOf("/")===-1&&(a=k(a)),/^[a-zA-Z]:(\/|$)/.test(a)&&(a="/"+a),a}e.toPosixPath=A;function w(a,i=O.posix.sep){if(!a)return"";const h=a.length,l=a.charCodeAt(0);if(q(l)){if(q(a.charCodeAt(1))&&!q(a.charCodeAt(2))){let L=3;const U=L;for(;L<h&&!q(a.charCodeAt(L));L++);if(U!==L&&!q(a.charCodeAt(L+1))){for(L+=1;L<h;L++)if(q(a.charCodeAt(L)))return a.slice(0,L+1).replace(/[\\/]/g,i)}}return i}else if(t(l)&&a.charCodeAt(1)===58)return q(a.charCodeAt(2))?a.slice(0,2)+i:a.slice(0,2);let d=a.indexOf("://");if(d!==-1){for(d+=3;d<h;d++)if(q(a.charCodeAt(d)))return a.slice(0,d+1)}return""}e.getRoot=w;function S(a){if(!F.isWindows||!a||a.length<5)return!1;let i=a.charCodeAt(0);if(i!==92||(i=a.charCodeAt(1),i!==92))return!1;let h=2;const l=h;for(;h<a.length&&(i=a.charCodeAt(h),i!==92);h++);return!(l===h||(i=a.charCodeAt(h+1),isNaN(i)||i===92))}e.isUNC=S;const T=/[\\/:\*\?"<>\|]/g,_=/[\\/]/g,N=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function b(a,i=F.isWindows){const h=i?T:_;return!(!a||a.length===0||/^\s+$/.test(a)||(h.lastIndex=0,h.test(a))||i&&N.test(a)||a==="."||a===".."||i&&a[a.length-1]==="."||i&&a.length!==a.trim().length||a.length>255)}e.isValidBasename=b;function c(a,i,h){const l=a===i;return!h||l?l:!a||!i?!1:(0,D.equalsIgnoreCase)(a,i)}e.isEqual=c;function o(a,i,h,l=O.sep){if(a===i)return!0;if(!a||!i||i.length>a.length)return!1;if(h){if(!(0,D.startsWithIgnoreCase)(a,i))return!1;if(i.length===a.length)return!0;let L=i.length;return i.charAt(i.length-1)===l&&L--,a.charAt(L)===l}return i.charAt(i.length-1)!==l&&(i+=l),a.indexOf(i)===0}e.isEqualOrParent=o;function t(a){return a>=65&&a<=90||a>=97&&a<=122}e.isWindowsDriveLetter=t;function s(a,i){return F.isWindows&&a.endsWith(":")&&(a+=O.sep),(0,O.isAbsolute)(a)||(a=(0,O.join)(i,a)),a=(0,O.normalize)(a),F.isWindows?(a=(0,D.rtrim)(a,O.sep),a.endsWith(":")&&(a+=O.sep)):(a=(0,D.rtrim)(a,O.sep),a||(a=O.sep)),a}e.sanitizeFilePath=s;function r(a){const i=(0,O.normalize)(a);return F.isWindows?a.length>3?!1:u(i)&&(a.length===2||i.charCodeAt(2)===92):i===O.posix.sep}e.isRootOrDriveLetter=r;function u(a,i){return(i!==void 0?i:F.isWindows)?t(a.charCodeAt(0))&&a.charCodeAt(1)===58:!1}e.hasDriveLetter=u;function f(a){return u(a)?a[0]:void 0}e.getDriveLetter=f;function g(a,i,h){return i.length>a.length?-1:a===i?0:(h&&(a=a.toLowerCase(),i=i.toLowerCase()),a.indexOf(i))}e.indexOfPath=g;function C(a){const i=a.split(":");let h,l,d;for(const L of i){const U=Number(L);(0,E.isNumber)(U)?l===void 0?l=U:d===void 0&&(d=U):h=h?[h,L].join(":"):L}if(!h)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:h,line:l!==void 0?l:void 0,column:d!==void 0?d:l!==void 0?1:void 0}}e.parseLineAndColumnAware=C;const I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function M(a,i,h=8){let l="";for(let L=0;L<h;L++)l+=I.charAt(Math.floor(Math.random()*I.length));let d;return i?d=`${i}-${l}`:d=l,a?(0,O.join)(a,d):d}e.randomPath=M}),define(ne[8],ie([0,1,3,9]),function(Z,e,O,F){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileAccess=e.RemoteAuthorities=e.connectionTokenQueryName=e.connectionTokenCookieName=e.Schemas=void 0;var D;(function(k){k.inMemory="inmemory",k.vscode="vscode",k.internal="private",k.walkThrough="walkThrough",k.walkThroughSnippet="walkThroughSnippet",k.http="http",k.https="https",k.file="file",k.mailto="mailto",k.untitled="untitled",k.data="data",k.command="command",k.vscodeRemote="vscode-remote",k.vscodeRemoteResource="vscode-remote-resource",k.vscodeUserData="vscode-userdata",k.vscodeCustomEditor="vscode-custom-editor",k.vscodeNotebook="vscode-notebook",k.vscodeNotebookCell="vscode-notebook-cell",k.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",k.vscodeNotebookCellOutput="vscode-notebook-cell-output",k.vscodeInteractive="vscode-interactive",k.vscodeInteractiveInput="vscode-interactive-input",k.vscodeSettings="vscode-settings",k.vscodeWorkspaceTrust="vscode-workspace-trust",k.vscodeTerminal="vscode-terminal",k.webviewPanel="webview-panel",k.vscodeWebview="vscode-webview",k.extension="extension",k.vscodeFileResource="vscode-file",k.tmp="tmp",k.vsls="vsls"})(D=e.Schemas||(e.Schemas={})),e.connectionTokenCookieName="vscode-tkn",e.connectionTokenQueryName="tkn";class E{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null}setPreferredWebSchema(A){this._preferredWebSchema=A}setDelegate(A){this._delegate=A}set(A,w,S){this._hosts[A]=w,this._ports[A]=S}setConnectionToken(A,w){this._connectionTokens[A]=w}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(A){if(this._delegate)return this._delegate(A);const w=A.authority;let S=this._hosts[w];S&&S.indexOf(":")!==-1&&(S=`[${S}]`);const T=this._ports[w],_=this._connectionTokens[w];let N=`path=${encodeURIComponent(A.path)}`;return typeof _=="string"&&(N+=`&${e.connectionTokenQueryName}=${encodeURIComponent(_)}`),F.URI.from({scheme:O.isWeb?this._preferredWebSchema:D.vscodeRemoteResource,authority:`${S}:${T}`,path:"/vscode-remote-resource",query:N})}}e.RemoteAuthorities=new E;class q{asBrowserUri(A,w){const S=this.toUri(A,w);return S.scheme===D.vscodeRemote?e.RemoteAuthorities.rewrite(S):S.scheme===D.file&&(O.isNative||O.isWebWorker&&O.globals.origin===`${D.vscodeFileResource}://${q.FALLBACK_AUTHORITY}`)?S.with({scheme:D.vscodeFileResource,authority:S.authority||q.FALLBACK_AUTHORITY,query:null,fragment:null}):S}asFileUri(A,w){const S=this.toUri(A,w);return S.scheme===D.vscodeFileResource?S.with({scheme:D.file,authority:S.authority!==q.FALLBACK_AUTHORITY?S.authority:null,query:null,fragment:null}):S}toUri(A,w){return F.URI.isUri(A)?A:F.URI.parse(w.toUrl(A))}}q.FALLBACK_AUTHORITY="vscode-app",e.FileAccess=new q}),define(ne[16],ie([0,1,7,8,4,3,2,9]),function(Z,e,O,F,D,E,q,k){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toLocalResource=e.DataUri=e.distinctParents=e.addTrailingPathSeparator=e.removeTrailingPathSeparator=e.hasTrailingPathSeparator=e.isEqualAuthority=e.isAbsolutePath=e.resolvePath=e.relativePath=e.normalizePath=e.joinPath=e.dirname=e.extname=e.basename=e.basenameOrAuthority=e.getComparisonKey=e.isEqualOrParent=e.isEqual=e.extUriIgnorePathCase=e.extUriBiasedIgnorePathCase=e.extUri=e.ExtUri=e.originalFSPath=void 0;function A(N){return(0,k.uriToFsPath)(N,!0)}e.originalFSPath=A;class w{constructor(b){this._ignorePathCasing=b}compare(b,c,o=!1){return b===c?0:(0,q.compare)(this.getComparisonKey(b,o),this.getComparisonKey(c,o))}isEqual(b,c,o=!1){return b===c?!0:!b||!c?!1:this.getComparisonKey(b,o)===this.getComparisonKey(c,o)}getComparisonKey(b,c=!1){return b.with({path:this._ignorePathCasing(b)?b.path.toLowerCase():void 0,fragment:c?null:void 0}).toString()}ignorePathCasing(b){return this._ignorePathCasing(b)}isEqualOrParent(b,c,o=!1){if(b.scheme===c.scheme){if(b.scheme===F.Schemas.file)return O.isEqualOrParent(A(b),A(c),this._ignorePathCasing(b))&&b.query===c.query&&(o||b.fragment===c.fragment);if((0,e.isEqualAuthority)(b.authority,c.authority))return O.isEqualOrParent(b.path,c.path,this._ignorePathCasing(b),"/")&&b.query===c.query&&(o||b.fragment===c.fragment)}return!1}joinPath(b,...c){return k.URI.joinPath(b,...c)}basenameOrAuthority(b){return(0,e.basename)(b)||b.authority}basename(b){return D.posix.basename(b.path)}extname(b){return D.posix.extname(b.path)}dirname(b){if(b.path.length===0)return b;let c;return b.scheme===F.Schemas.file?c=k.URI.file(D.dirname(A(b))).path:(c=D.posix.dirname(b.path),b.authority&&c.length&&c.charCodeAt(0)!==47&&(console.error(`dirname("${b.toString})) resulted in a relative path`),c="/")),b.with({path:c})}normalizePath(b){if(!b.path.length)return b;let c;return b.scheme===F.Schemas.file?c=k.URI.file(D.normalize(A(b))).path:c=D.posix.normalize(b.path),b.with({path:c})}relativePath(b,c){if(b.scheme!==c.scheme||!(0,e.isEqualAuthority)(b.authority,c.authority))return;if(b.scheme===F.Schemas.file){const s=D.relative(A(b),A(c));return E.isWindows?O.toSlashes(s):s}let o=b.path||"/",t=c.path||"/";if(this._ignorePathCasing(b)){let s=0;for(const r=Math.min(o.length,t.length);s<r&&!(o.charCodeAt(s)!==t.charCodeAt(s)&&o.charAt(s).toLowerCase()!==t.charAt(s).toLowerCase());s++);o=t.substr(0,s)+o.substr(s)}return D.posix.relative(o,t)}resolvePath(b,c){if(b.scheme===F.Schemas.file){const o=k.URI.file(D.resolve(A(b),c));return b.with({authority:o.authority,path:o.path})}return c=O.toPosixPath(c),b.with({path:D.posix.resolve(b.path,c)})}isAbsolutePath(b){return!!b.path&&b.path[0]==="/"}isEqualAuthority(b,c){return b===c||b!==void 0&&c!==void 0&&(0,q.equalsIgnoreCase)(b,c)}hasTrailingPathSeparator(b,c=D.sep){if(b.scheme===F.Schemas.file){const o=A(b);return o.length>O.getRoot(o).length&&o[o.length-1]===c}else{const o=b.path;return o.length>1&&o.charCodeAt(o.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(b.fsPath)}}removeTrailingPathSeparator(b,c=D.sep){return(0,e.hasTrailingPathSeparator)(b,c)?b.with({path:b.path.substr(0,b.path.length-1)}):b}addTrailingPathSeparator(b,c=D.sep){let o=!1;if(b.scheme===F.Schemas.file){const t=A(b);o=t!==void 0&&t.length===O.getRoot(t).length&&t[t.length-1]===c}else{c="/";const t=b.path;o=t.length===1&&t.charCodeAt(t.length-1)===47}return!o&&!(0,e.hasTrailingPathSeparator)(b,c)?b.with({path:b.path+"/"}):b}}e.ExtUri=w,e.extUri=new w(()=>!1),e.extUriBiasedIgnorePathCase=new w(N=>N.scheme===F.Schemas.file?!E.isLinux:!0),e.extUriIgnorePathCase=new w(N=>!0),e.isEqual=e.extUri.isEqual.bind(e.extUri),e.isEqualOrParent=e.extUri.isEqualOrParent.bind(e.extUri),e.getComparisonKey=e.extUri.getComparisonKey.bind(e.extUri),e.basenameOrAuthority=e.extUri.basenameOrAuthority.bind(e.extUri),e.basename=e.extUri.basename.bind(e.extUri),e.extname=e.extUri.extname.bind(e.extUri),e.dirname=e.extUri.dirname.bind(e.extUri),e.joinPath=e.extUri.joinPath.bind(e.extUri),e.normalizePath=e.extUri.normalizePath.bind(e.extUri),e.relativePath=e.extUri.relativePath.bind(e.extUri),e.resolvePath=e.extUri.resolvePath.bind(e.extUri),e.isAbsolutePath=e.extUri.isAbsolutePath.bind(e.extUri),e.isEqualAuthority=e.extUri.isEqualAuthority.bind(e.extUri),e.hasTrailingPathSeparator=e.extUri.hasTrailingPathSeparator.bind(e.extUri),e.removeTrailingPathSeparator=e.extUri.removeTrailingPathSeparator.bind(e.extUri),e.addTrailingPathSeparator=e.extUri.addTrailingPathSeparator.bind(e.extUri);function S(N,b){const c=[];for(let o=0;o<N.length;o++){const t=b(N[o]);N.some((s,r)=>r===o?!1:(0,e.isEqualOrParent)(t,b(s)))||c.push(N[o])}return c}e.distinctParents=S;var T;(function(N){N.META_DATA_LABEL="label",N.META_DATA_DESCRIPTION="description",N.META_DATA_SIZE="size",N.META_DATA_MIME="mime";function b(c){const o=new Map;c.path.substring(c.path.indexOf(";")+1,c.path.lastIndexOf(";")).split(";").forEach(r=>{const[u,f]=r.split(":");u&&f&&o.set(u,f)});const s=c.path.substring(0,c.path.indexOf(";"));return s&&o.set(N.META_DATA_MIME,s),o}N.parseMetaData=b})(T=e.DataUri||(e.DataUri={}));function _(N,b,c){if(b){let o=N.path;return o&&o[0]!==D.posix.sep&&(o=D.posix.sep+o),N.with({scheme:c,authority:b,path:o})}return N.with({scheme:c})}e.toLocalResource=_}),define(ne[17],ie([0,1,32,14,18,5,16,3]),function(Z,e,O,F,D,E,q,k){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createCancelableAsyncIterable=e.CancelableAsyncIterableObject=e.AsyncIterableObject=e.Promises=e.DeferredPromise=e.IntervalCounter=e.TaskSequentializer=e.retry=e.IdleValue=e.runWhenIdle=e.ThrottledWorker=e.RunOnceWorker=e.ProcessTimeRunOnceScheduler=e.RunOnceScheduler=e.IntervalTimer=e.TimeoutTimer=e.ResourceQueue=e.Queue=e.Limiter=e.firstParallel=e.first=e.sequence=e.disposableTimeout=e.timeout=e.AutoOpenBarrier=e.Barrier=e.ThrottledDelayer=e.Delayer=e.MicrotaskDelay=e.SequencerByKey=e.Sequencer=e.Throttler=e.asPromise=e.raceTimeout=e.raceCancellablePromises=e.raceCancellationError=e.raceCancellation=e.createCancelablePromise=e.isThenable=void 0;function A(R){return!!R&&typeof R.then=="function"}e.isThenable=A;function w(R){const m=new O.CancellationTokenSource,y=R(m.token),B=new Promise((V,G)=>{const ee=m.token.onCancellationRequested(()=>{ee.dispose(),m.dispose(),G(new F.CancellationError)});Promise.resolve(y).then(te=>{ee.dispose(),m.dispose(),V(te)},te=>{ee.dispose(),m.dispose(),G(te)})});return new class{cancel(){m.cancel()}then(V,G){return B.then(V,G)}catch(V){return this.then(void 0,V)}finally(V){return B.finally(V)}}}e.createCancelablePromise=w;function S(R,m,y){return new Promise((B,V)=>{const G=m.onCancellationRequested(()=>{G.dispose(),B(y)});R.then(B,V).finally(()=>G.dispose())})}e.raceCancellation=S;function T(R,m){return new Promise((y,B)=>{const V=m.onCancellationRequested(()=>{V.dispose(),B(new F.CancellationError)});R.then(y,B).finally(()=>V.dispose())})}e.raceCancellationError=T;async function _(R){let m=-1;const y=R.map((V,G)=>V.then(ee=>(m=G,ee))),B=await Promise.race(y);return R.forEach((V,G)=>{G!==m&&V.cancel()}),B}e.raceCancellablePromises=_;function N(R,m,y){let B;const V=setTimeout(()=>{B?.(void 0),y?.()},m);return Promise.race([R.finally(()=>clearTimeout(V)),new Promise(G=>B=G)])}e.raceTimeout=N;function b(R){return new Promise((m,y)=>{const B=R();A(B)?B.then(m,y):m(B)})}e.asPromise=b;class c{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(m){if(this.activePromise){if(this.queuedPromiseFactory=m,!this.queuedPromise){const y=()=>{this.queuedPromise=null;const B=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,B};this.queuedPromise=new Promise(B=>{this.activePromise.then(y,y).then(B)})}return new Promise((y,B)=>{this.queuedPromise.then(y,B)})}return this.activePromise=m(),new Promise((y,B)=>{this.activePromise.then(V=>{this.activePromise=null,y(V)},V=>{this.activePromise=null,B(V)})})}}e.Throttler=c;class o{constructor(){this.current=Promise.resolve(null)}queue(m){return this.current=this.current.then(()=>m(),()=>m())}}e.Sequencer=o;class t{constructor(){this.promiseMap=new Map}queue(m,y){const V=(this.promiseMap.get(m)??Promise.resolve()).catch(()=>{}).then(y).finally(()=>{this.promiseMap.get(m)===V&&this.promiseMap.delete(m)});return this.promiseMap.set(m,V),V}}e.SequencerByKey=t;const s=(R,m)=>{let y=!0;const B=setTimeout(()=>{y=!1,m()},R);return{isTriggered:()=>y,dispose:()=>{clearTimeout(B),y=!1}}},r=R=>{let m=!0;return queueMicrotask(()=>{m&&(m=!1,R())}),{isTriggered:()=>m,dispose:()=>{m=!1}}};e.MicrotaskDelay=Symbol("MicrotaskDelay");class u{constructor(m){this.defaultDelay=m,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(m,y=this.defaultDelay){this.task=m,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((V,G)=>{this.doResolve=V,this.doReject=G}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const V=this.task;return this.task=null,V()}}));const B=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=y===e.MicrotaskDelay?r(B):s(y,B),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject&&this.doReject(new F.CancellationError),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}}e.Delayer=u;class f{constructor(m){this.delayer=new u(m),this.throttler=new c}trigger(m,y){return this.delayer.trigger(()=>this.throttler.queue(m),y)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose()}}e.ThrottledDelayer=f;class g{constructor(){this._isOpen=!1,this._promise=new Promise((m,y)=>{this._completePromise=m})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}e.Barrier=g;class C extends g{constructor(m){super();this._timeout=setTimeout(()=>this.open(),m)}open(){clearTimeout(this._timeout),super.open()}}e.AutoOpenBarrier=C;function I(R,m){return m?new Promise((y,B)=>{const V=setTimeout(()=>{G.dispose(),y()},R),G=m.onCancellationRequested(()=>{clearTimeout(V),G.dispose(),B(new F.CancellationError)})}):w(y=>I(R,y))}e.timeout=I;function M(R,m=0){const y=setTimeout(R,m);return(0,E.toDisposable)(()=>clearTimeout(y))}e.disposableTimeout=M;function a(R){const m=[];let y=0;const B=R.length;function V(){return y<B?R[y++]():null}function G(ee){ee!=null&&m.push(ee);const te=V();return te?te.then(G):Promise.resolve(m)}return Promise.resolve(null).then(G)}e.sequence=a;function i(R,m=B=>!!B,y=null){let B=0;const V=R.length,G=()=>{if(B>=V)return Promise.resolve(y);const ee=R[B++];return Promise.resolve(ee()).then(se=>m(se)?Promise.resolve(se):G())};return G()}e.first=i;function h(R,m=B=>!!B,y=null){if(R.length===0)return Promise.resolve(y);let B=R.length;const V=()=>{B=-1;for(const G of R)G.cancel?.()};return new Promise((G,ee)=>{for(const te of R)te.then(se=>{--B>=0&&m(se)?(V(),G(se)):B===0&&G(y)}).catch(se=>{--B>=0&&(V(),ee(se))})})}e.firstParallel=h;class l{constructor(m){this._size=0,this.maxDegreeOfParalellism=m,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new D.Emitter}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(m){return this._size++,new Promise((y,B)=>{this.outstandingPromises.push({factory:m,c:y,e:B}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const m=this.outstandingPromises.shift();this.runningPromises++;const y=m.factory();y.then(m.c,m.e),y.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._size--,this.runningPromises--,this.outstandingPromises.length>0?this.consume():this._onDrained.fire()}dispose(){this._onDrained.dispose()}}e.Limiter=l;class d extends l{constructor(){super(1)}}e.Queue=d;class L{constructor(){this.queues=new Map,this.drainers=new Set}async whenDrained(){if(this.isDrained())return;const m=new $;return this.drainers.add(m),m.p}isDrained(){for(const[,m]of this.queues)if(m.size>0)return!1;return!0}queueFor(m,y=q.extUri){const B=y.getComparisonKey(m);let V=this.queues.get(B);return V||(V=new d,D.Event.once(V.onDrained)(()=>{V?.dispose(),this.queues.delete(B),this.onDidQueueDrain()}),this.queues.set(B,V)),V}onDidQueueDrain(){!this.isDrained()||this.releaseDrainers()}releaseDrainers(){for(const m of this.drainers)m.complete();this.drainers.clear()}dispose(){for(const[,m]of this.queues)m.dispose();this.queues.clear(),this.releaseDrainers()}}e.ResourceQueue=L;class U{constructor(m,y){this._token=-1,typeof m=="function"&&typeof y=="number"&&this.setIfNotSet(m,y)}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(m,y){this.cancel(),this._token=setTimeout(()=>{this._token=-1,m()},y)}setIfNotSet(m,y){this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,m()},y))}}e.TimeoutTimer=U;class z{constructor(){this._token=-1}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearInterval(this._token),this._token=-1)}cancelAndSet(m,y){this.cancel(),this._token=setInterval(()=>{m()},y)}}e.IntervalTimer=z;class P{constructor(m,y){this.timeoutToken=-1,this.runner=m,this.timeout=y,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(m=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,m)}get delay(){return this.timeout}set delay(m){this.timeout=m}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner&&this.runner()}}e.RunOnceScheduler=P;class n{constructor(m,y){y%1e3!=0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${y}ms is not a multiple of 1000ms.`),this.runner=m,this.timeout=y,this.counter=0,this.intervalToken=-1,this.intervalHandler=this.onInterval.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearInterval(this.intervalToken),this.intervalToken=-1)}schedule(m=this.timeout){m%1e3!=0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${m}ms is not a multiple of 1000ms.`),this.cancel(),this.counter=Math.ceil(m/1e3),this.intervalToken=setInterval(this.intervalHandler,1e3)}isScheduled(){return this.intervalToken!==-1}onInterval(){this.counter--,!(this.counter>0)&&(clearInterval(this.intervalToken),this.intervalToken=-1,this.runner&&this.runner())}}e.ProcessTimeRunOnceScheduler=n;class p extends P{constructor(m,y){super(m,y);this.units=[]}work(m){this.units.push(m),this.isScheduled()||this.schedule()}doRun(){const m=this.units;this.units=[],this.runner&&this.runner(m)}dispose(){this.units=[],super.dispose()}}e.RunOnceWorker=p;class v extends E.Disposable{constructor(m,y){super();this.options=m,this.handler=y,this.pendingWork=[],this.throttler=this._register(new E.MutableDisposable),this.disposed=!1}get pending(){return this.pendingWork.length}work(m){if(this.disposed)return!1;if(typeof this.options.maxBufferedWork=="number"){if(this.throttler.value){if(this.pending+m.length>this.options.maxBufferedWork)return!1}else if(this.pending+m.length-this.options.maxWorkChunkSize>this.options.maxBufferedWork)return!1}return this.pendingWork.push(...m),this.throttler.value||this.doWork(),!0}doWork(){this.handler(this.pendingWork.splice(0,this.options.maxWorkChunkSize)),this.pendingWork.length>0&&(this.throttler.value=new P(()=>{this.throttler.clear(),this.doWork()},this.options.throttleDelay),this.throttler.value.schedule())}dispose(){super.dispose(),this.disposed=!0}}e.ThrottledWorker=v,function(){typeof requestIdleCallback!="function"||typeof cancelIdleCallback!="function"?e.runWhenIdle=R=>{(0,k.setTimeout0)(()=>{if(m)return;const y=Date.now()+15;R(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,y-Date.now())}}))});let m=!1;return{dispose(){m||(m=!0)}}}:e.runWhenIdle=(R,m)=>{const y=requestIdleCallback(R,typeof m=="number"?{timeout:m}:void 0);let B=!1;return{dispose(){B||(B=!0,cancelIdleCallback(y))}}}}();class K{constructor(m){this._didRun=!1,this._executor=()=>{try{this._value=m()}catch(y){this._error=y}finally{this._didRun=!0}},this._handle=(0,e.runWhenIdle)(()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}e.IdleValue=K;async function X(R,m,y){let B;for(let V=0;V<y;V++)try{return await R()}catch(G){B=G,await I(m)}throw B}e.retry=X;class W{hasPending(m){return this._pending?typeof m=="number"?this._pending.taskId===m:!!this._pending:!1}get pending(){return this._pending?this._pending.promise:void 0}cancelPending(){this._pending?.cancel()}setPending(m,y,B){return this._pending={taskId:m,cancel:()=>B?.(),promise:y},y.then(()=>this.donePending(m),()=>this.donePending(m)),y}donePending(m){this._pending&&m===this._pending.taskId&&(this._pending=void 0,this.triggerNext())}triggerNext(){if(this._next){const m=this._next;this._next=void 0,m.run().then(m.promiseResolve,m.promiseReject)}}setNext(m){if(this._next)this._next.run=m;else{let y,B;const V=new Promise((G,ee)=>{y=G,B=ee});this._next={run:m,promise:V,promiseResolve:y,promiseReject:B}}return this._next.promise}}e.TaskSequentializer=W;class j{constructor(m,y=()=>Date.now()){this.interval=m,this.nowFn=y,this.lastIncrementTime=0,this.value=0}increment(){const m=this.nowFn();return m-this.lastIncrementTime>this.interval&&(this.lastIncrementTime=m,this.value=0),this.value++,this.value}}e.IntervalCounter=j;class ${constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise((m,y)=>{this.completeCallback=m,this.errorCallback=y})}get isRejected(){return this.rejected}get isResolved(){return this.resolved}get isSettled(){return this.rejected||this.resolved}complete(m){return new Promise(y=>{this.completeCallback(m),this.resolved=!0,y()})}error(m){return new Promise(y=>{this.errorCallback(m),this.rejected=!0,y()})}cancel(){new Promise(m=>{this.errorCallback(new F.CancellationError),this.rejected=!0,m()})}}e.DeferredPromise=$;var Y;(function(R){async function m(B){let V;const G=await Promise.all(B.map(ee=>ee.then(te=>te,te=>{V||(V=te)})));if(typeof V!="undefined")throw V;return G}R.settled=m;function y(B){return new Promise(async(V,G)=>{try{await B(V,G)}catch(ee){G(ee)}})}R.withAsyncBody=y})(Y=e.Promises||(e.Promises={}));var Q;(function(R){R[R.Initial=0]="Initial",R[R.DoneOK=1]="DoneOK",R[R.DoneError=2]="DoneError"})(Q||(Q={}));class H{constructor(m){this._state=0,this._results=[],this._error=null,this._onStateChanged=new D.Emitter,queueMicrotask(async()=>{const y={emitOne:B=>this.emitOne(B),emitMany:B=>this.emitMany(B),reject:B=>this.reject(B)};try{await Promise.resolve(m(y)),this.resolve()}catch(B){this.reject(B)}finally{y.emitOne=void 0,y.emitMany=void 0,y.reject=void 0}})}static fromArray(m){return new H(y=>{y.emitMany(m)})}static fromPromise(m){return new H(async y=>{y.emitMany(await m)})}static fromPromises(m){return new H(async y=>{await Promise.all(m.map(async B=>y.emitOne(await B)))})}static merge(m){return new H(async y=>{await Promise.all(m.map(async B=>{for await(const V of B)y.emitOne(V)}))})}[Symbol.asyncIterator](){let m=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(m<this._results.length)return{done:!1,value:this._results[m++]};if(this._state===1)return{done:!0,value:void 0};await D.Event.toPromise(this._onStateChanged.event)}while(!0)}}}static map(m,y){return new H(async B=>{for await(const V of m)B.emitOne(y(V))})}map(m){return H.map(this,m)}static filter(m,y){return new H(async B=>{for await(const V of m)y(V)&&B.emitOne(V)})}filter(m){return H.filter(this,m)}static coalesce(m){return H.filter(m,y=>!!y)}coalesce(){return H.coalesce(this)}static async toPromise(m){const y=[];for await(const B of m)y.push(B);return y}toPromise(){return H.toPromise(this)}emitOne(m){this._state===0&&(this._results.push(m),this._onStateChanged.fire())}emitMany(m){this._state===0&&(this._results=this._results.concat(m),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(m){this._state===0&&(this._state=2,this._error=m,this._onStateChanged.fire())}}e.AsyncIterableObject=H,H.EMPTY=H.fromArray([]);class J extends H{constructor(m,y){super(y);this._source=m}cancel(){this._source.cancel()}}e.CancelableAsyncIterableObject=J;function x(R){const m=new O.CancellationTokenSource,y=R(m.token);return new J(m,async B=>{const V=m.token.onCancellationRequested(()=>{V.dispose(),m.dispose(),B.reject(new F.CancellationError)});try{for await(const G of y){if(m.token.isCancellationRequested)return;B.emitOne(G)}V.dispose(),m.dispose()}catch(G){V.dispose(),m.dispose(),B.reject(G)}})}e.createCancelableAsyncIterable=x}),define(ne[19],ie([0,1,17,7,15,4,3,2]),function(Z,e,O,F,D,E,q,k){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getPathTerms=e.getBasenameTerms=e.isRelativePattern=e.parse=e.match=e.splitGlobAware=e.GLOB_SPLIT=e.GLOBSTAR=e.getEmptyExpression=void 0;function A(){return Object.create(null)}e.getEmptyExpression=A,e.GLOBSTAR="**",e.GLOB_SPLIT="/";const w="[/\\\\]",S="[^/\\\\]",T=/\//g;function _(W,j){switch(W){case 0:return"";case 1:return`${S}*?`;default:return`(?:${w}|${S}+${w}${j?`|${w}${S}+`:""})*?`}}function N(W,j){if(!W)return[];const $=[];let Y=!1,Q=!1,H="";for(const J of W){switch(J){case j:if(!Y&&!Q){$.push(H),H="";continue}break;case"{":Y=!0;break;case"}":Y=!1;break;case"[":Q=!0;break;case"]":Q=!1;break}H+=J}return H&&$.push(H),$}e.splitGlobAware=N;function b(W){if(!W)return"";let j="";const $=N(W,e.GLOB_SPLIT);if($.every(Y=>Y===e.GLOBSTAR))j=".*";else{let Y=!1;$.forEach((Q,H)=>{if(Q===e.GLOBSTAR){if(Y)return;j+=_(2,H===$.length-1)}else{let J=!1,x="",R=!1,m="";for(const y of Q){if(y!=="}"&&J){x+=y;continue}if(R&&(y!=="]"||!m)){let B;y==="-"?B=y:(y==="^"||y==="!")&&!m?B="^":y===e.GLOB_SPLIT?B="":B=(0,k.escapeRegExpCharacters)(y),m+=B;continue}switch(y){case"{":J=!0;continue;case"[":R=!0;continue;case"}":{j+=`(?:${N(x,",").map(G=>b(G)).join("|")})`,J=!1,x="";break}case"]":{j+="["+m+"]",R=!1,m="";break}case"?":j+=S;continue;case"*":j+=_(1);continue;default:j+=(0,k.escapeRegExpCharacters)(y)}}H<$.length-1&&($[H+1]!==e.GLOBSTAR||H+2<$.length)&&(j+=w)}Y=Q===e.GLOBSTAR})}return j}const c=/^\*\*\/\*\.[\w\.-]+$/,o=/^\*\*\/([\w\.-]+)\/?$/,t=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,s=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,r=/^\*\*((\/[\w\.-]+)+)\/?$/,u=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,f=new D.LRUCache(1e4),g=function(){return!1},C=function(){return null};function I(W,j){if(!W)return C;let $;typeof W!="string"?$=W.pattern:$=W,$=$.trim();const Y=`${$}_${!!j.trimForExclusions}`;let Q=f.get(Y);if(Q)return M(Q,W);let H;return c.test($)?Q=i($.substr(4),$):(H=o.exec(a($,j)))?Q=h(H[1],$):(j.trimForExclusions?s:t).test($)?Q=l($,j):(H=r.exec(a($,j)))?Q=d(H[1].substr(1),$,!0):(H=u.exec(a($,j)))?Q=d(H[1],$,!1):Q=L($),f.set(Y,Q),M(Q,W)}function M(W,j){if(typeof j=="string")return W;const $=function(Y,Q){return(0,F.isEqualOrParent)(Y,j.base,!q.isLinux)?W(Y.substr(j.base.length+1),Q):null};return $.allBasenames=W.allBasenames,$.allPaths=W.allPaths,$.basenames=W.basenames,$.patterns=W.patterns,$}function a(W,j){return j.trimForExclusions&&W.endsWith("/**")?W.substr(0,W.length-2):W}function i(W,j){return function($,Y){return typeof $=="string"&&$.endsWith(W)?j:null}}function h(W,j){const $=`/${W}`,Y=`\\${W}`,Q=function(J,x){return typeof J!="string"?null:x?x===W?j:null:J===W||J.endsWith($)||J.endsWith(Y)?j:null},H=[W];return Q.basenames=H,Q.patterns=[j],Q.allBasenames=H,Q}function l(W,j){const $=X(W.slice(1,-1).split(",").map(x=>I(x,j)).filter(x=>x!==C),W),Y=$.length;if(!Y)return C;if(Y===1)return $[0];const Q=function(x,R){for(let m=0,y=$.length;m<y;m++)if($[m](x,R))return W;return null},H=$.find(x=>!!x.allBasenames);H&&(Q.allBasenames=H.allBasenames);const J=$.reduce((x,R)=>R.allPaths?x.concat(R.allPaths):x,[]);return J.length&&(Q.allPaths=J),Q}function d(W,j,$){const Y=E.sep===E.posix.sep,Q=Y?W:W.replace(T,E.sep),H=E.sep+Q,J=E.posix.sep+W;let x;return $?x=function(R,m){return typeof R=="string"&&(R===Q||R.endsWith(H)||!Y&&(R===W||R.endsWith(J)))?j:null}:x=function(R,m){return typeof R=="string"&&(R===Q||!Y&&R===W)?j:null},x.allPaths=[($?"*/":"./")+W],x}function L(W){try{const j=new RegExp(`^${b(W)}$`);return function($){return j.lastIndex=0,typeof $=="string"&&j.test($)?W:null}}catch{return C}}function U(W,j,$){return!W||typeof j!="string"?!1:z(W)(j,void 0,$)}e.match=U;function z(W,j={}){if(!W)return g;if(typeof W=="string"||P(W)){const $=I(W,j);if($===C)return g;const Y=function(Q,H){return!!$(Q,H)};return $.allBasenames&&(Y.allBasenames=$.allBasenames),$.allPaths&&(Y.allPaths=$.allPaths),Y}return v(W,j)}e.parse=z;function P(W){const j=W;return j?typeof j.base=="string"&&typeof j.pattern=="string":!1}e.isRelativePattern=P;function n(W){return W.allBasenames||[]}e.getBasenameTerms=n;function p(W){return W.allPaths||[]}e.getPathTerms=p;function v(W,j){const $=X(Object.getOwnPropertyNames(W).map(x=>K(x,W[x],j)).filter(x=>x!==C)),Y=$.length;if(!Y)return C;if(!$.some(x=>!!x.requiresSiblings)){if(Y===1)return $[0];const x=function(y,B){let V;for(let G=0,ee=$.length;G<ee;G++){const te=$[G](y,B);if(typeof te=="string")return te;(0,O.isThenable)(te)&&(V||(V=[]),V.push(te))}return V?(async()=>{for(const G of V){const ee=await G;if(typeof ee=="string")return ee}return null})():null},R=$.find(y=>!!y.allBasenames);R&&(x.allBasenames=R.allBasenames);const m=$.reduce((y,B)=>B.allPaths?y.concat(B.allPaths):y,[]);return m.length&&(x.allPaths=m),x}const Q=function(x,R,m){let y,B;for(let V=0,G=$.length;V<G;V++){const ee=$[V];ee.requiresSiblings&&m&&(R||(R=(0,E.basename)(x)),y||(y=R.substr(0,R.length-(0,E.extname)(x).length)));const te=ee(x,R,y,m);if(typeof te=="string")return te;(0,O.isThenable)(te)&&(B||(B=[]),B.push(te))}return B?(async()=>{for(const V of B){const G=await V;if(typeof G=="string")return G}return null})():null},H=$.find(x=>!!x.allBasenames);H&&(Q.allBasenames=H.allBasenames);const J=$.reduce((x,R)=>R.allPaths?x.concat(R.allPaths):x,[]);return J.length&&(Q.allPaths=J),Q}function K(W,j,$){if(j===!1)return C;const Y=I(W,$);if(Y===C)return C;if(typeof j=="boolean")return Y;if(j){const Q=j.when;if(typeof Q=="string"){const H=(J,x,R,m)=>{if(!m||!Y(J,x))return null;const y=Q.replace("$(basename)",R),B=m(y);return(0,O.isThenable)(B)?B.then(V=>V?W:null):B?W:null};return H.requiresSiblings=!0,H}}return Y}function X(W,j){const $=W.filter(x=>!!x.basenames);if($.length<2)return W;const Y=$.reduce((x,R)=>{const m=R.basenames;return m?x.concat(m):x},[]);let Q;if(j){Q=[];for(let x=0,R=Y.length;x<R;x++)Q.push(j)}else Q=$.reduce((x,R)=>{const m=R.patterns;return m?x.concat(m):x},[]);const H=function(x,R){if(typeof x!="string")return null;if(!R){let y;for(y=x.length;y>0;y--){const B=x.charCodeAt(y-1);if(B===47||B===92)break}R=x.substr(y)}const m=Y.indexOf(R);return m!==-1?Q[m]:null};H.basenames=Y,H.patterns=Q,H.allBasenames=Y;const J=W.filter(x=>!x.basenames);return J.push(H),J}}),define(ne[20],ie([0,1]),function(Z,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.countEOL=e.StringEOL=void 0;var O;(function(D){D[D.Unknown=0]="Unknown",D[D.Invalid=3]="Invalid",D[D.LF=1]="LF",D[D.CRLF=2]="CRLF"})(O=e.StringEOL||(e.StringEOL={}));function F(D){let E=0,q=0,k=0,A=0;for(let w=0,S=D.length;w<S;w++){const T=D.charCodeAt(w);T===13?(E===0&&(q=w),E++,w+1<S&&D.charCodeAt(w+1)===10?(A|=2,w++):A|=3,k=w+1):T===10&&(A|=1,E===0&&(q=w),E++,k=w+1)}return E===0&&(q=D.length),[E,q,D.length-k,A]}e.countEOL=F}),define(ne[21],ie([0,1,2,3,6]),function(Z,e,O,F,D){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decodeUTF16LE=e.createStringBuilder=e.hasTextDecoder=e.getPlatformTextDecoder=void 0;let E;function q(){return E||(E=new TextDecoder("UTF-16LE")),E}let k;function A(){return k||(k=new TextDecoder("UTF-16BE")),k}let w;function S(){return w||(w=F.isLittleEndian()?q():A()),w}e.getPlatformTextDecoder=S,e.hasTextDecoder=typeof TextDecoder!="undefined",e.hasTextDecoder?(e.createStringBuilder=c=>new N(c),e.decodeUTF16LE=T):(e.createStringBuilder=c=>new b,e.decodeUTF16LE=_);function T(c,o,t){const s=new Uint16Array(c.buffer,o,t);return t>0&&(s[0]===65279||s[0]===65534)?_(c,o,t):q().decode(s)}function _(c,o,t){const s=[];let r=0;for(let u=0;u<t;u++){const f=D.readUInt16LE(c,o);o+=2,s[r++]=String.fromCharCode(f)}return s.join("")}class N{constructor(o){this._capacity=o|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const o=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return S().decode(o)}_flushBuffer(){const o=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[o]:this._completedStrings[this._completedStrings.length]=o}write1(o){const t=this._capacity-this._bufferLength;t<=1&&(t===0||O.isHighSurrogate(o))&&this._flushBuffer(),this._buffer[this._bufferLength++]=o}appendASCII(o){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=o}appendASCIIString(o){const t=o.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=o;return}for(let s=0;s<t;s++)this._buffer[this._bufferLength++]=o.charCodeAt(s)}}class b{constructor(){this._pieces=[],this._piecesLen=0}reset(){this._pieces=[],this._piecesLen=0}build(){return this._pieces.join("")}write1(o){this._pieces[this._piecesLen++]=String.fromCharCode(o)}appendASCII(o){this._pieces[this._piecesLen++]=String.fromCharCode(o)}appendASCIIString(o){this._pieces[this._piecesLen++]=o}}}),define(ne[22],ie([0,1,6,21]),function(Z,e,O,F){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compressConsecutiveTextChanges=e.TextChange=void 0;function D(A){return A.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class E{constructor(w,S,T,_){this.oldPosition=w,this.oldText=S,this.newPosition=T,this.newText=_}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${D(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${D(this.oldText)}")`:`(replace@${this.oldPosition} "${D(this.oldText)}" with "${D(this.newText)}")`}static _writeStringSize(w){return 4+2*w.length}static _writeString(w,S,T){const _=S.length;O.writeUInt32BE(w,_,T),T+=4;for(let N=0;N<_;N++)O.writeUInt16LE(w,S.charCodeAt(N),T),T+=2;return T}static _readString(w,S){const T=O.readUInt32BE(w,S);return S+=4,(0,F.decodeUTF16LE)(w,S,T)}writeSize(){return 4+4+E._writeStringSize(this.oldText)+E._writeStringSize(this.newText)}write(w,S){return O.writeUInt32BE(w,this.oldPosition,S),S+=4,O.writeUInt32BE(w,this.newPosition,S),S+=4,S=E._writeString(w,this.oldText,S),S=E._writeString(w,this.newText,S),S}static read(w,S,T){const _=O.readUInt32BE(w,S);S+=4;const N=O.readUInt32BE(w,S);S+=4;const b=E._readString(w,S);S+=E._writeStringSize(b);const c=E._readString(w,S);return S+=E._writeStringSize(c),T.push(new E(_,b,N,c)),S}}e.TextChange=E;function q(A,w){return A===null||A.length===0?w:new k(A,w).compress()}e.compressConsecutiveTextChanges=q;class k{constructor(w,S){this._prevEdits=w,this._currEdits=S,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let w=0,S=0,T=this._getPrev(w),_=this._getCurr(S);for(;w<this._prevLen||S<this._currLen;){if(T===null){this._acceptCurr(_),_=this._getCurr(++S);continue}if(_===null){this._acceptPrev(T),T=this._getPrev(++w);continue}if(_.oldEnd<=T.newPosition){this._acceptCurr(_),_=this._getCurr(++S);continue}if(T.newEnd<=_.oldPosition){this._acceptPrev(T),T=this._getPrev(++w);continue}if(_.oldPosition<T.newPosition){const[t,s]=k._splitCurr(_,T.newPosition-_.oldPosition);this._acceptCurr(t),_=s;continue}if(T.newPosition<_.oldPosition){const[t,s]=k._splitPrev(T,_.oldPosition-T.newPosition);this._acceptPrev(t),T=s;continue}let c,o;if(_.oldEnd===T.newEnd)c=T,o=_,T=this._getPrev(++w),_=this._getCurr(++S);else if(_.oldEnd<T.newEnd){const[t,s]=k._splitPrev(T,_.oldLength);c=t,o=_,T=s,_=this._getCurr(++S)}else{const[t,s]=k._splitCurr(_,T.newLength);c=T,o=t,T=this._getPrev(++w),_=s}this._result[this._resultLen++]=new E(c.oldPosition,c.oldText,o.newPosition,o.newText),this._prevDeltaOffset+=c.newLength-c.oldLength,this._currDeltaOffset+=o.newLength-o.oldLength}const N=k._merge(this._result);return k._removeNoOps(N)}_acceptCurr(w){this._result[this._resultLen++]=k._rebaseCurr(this._prevDeltaOffset,w),this._currDeltaOffset+=w.newLength-w.oldLength}_getCurr(w){return w<this._currLen?this._currEdits[w]:null}_acceptPrev(w){this._result[this._resultLen++]=k._rebasePrev(this._currDeltaOffset,w),this._prevDeltaOffset+=w.newLength-w.oldLength}_getPrev(w){return w<this._prevLen?this._prevEdits[w]:null}static _rebaseCurr(w,S){return new E(S.oldPosition-w,S.oldText,S.newPosition,S.newText)}static _rebasePrev(w,S){return new E(S.oldPosition,S.oldText,S.newPosition+w,S.newText)}static _splitPrev(w,S){const T=w.newText.substr(0,S),_=w.newText.substr(S);return[new E(w.oldPosition,w.oldText,w.newPosition,T),new E(w.oldEnd,"",w.newPosition+S,_)]}static _splitCurr(w,S){const T=w.oldText.substr(0,S),_=w.oldText.substr(S);return[new E(w.oldPosition,T,w.newPosition,w.newText),new E(w.oldPosition+S,_,w.newEnd,"")]}static _merge(w){if(w.length===0)return w;const S=[];let T=0,_=w[0];for(let N=1;N<w.length;N++){const b=w[N];_.oldEnd===b.oldPosition?_=new E(_.oldPosition,_.oldText+b.oldText,_.newPosition,_.newText+b.newText):(S[T++]=_,_=b)}return S[T++]=_,S}static _removeNoOps(w){if(w.length===0)return w;const S=[];let T=0;for(let _=0;_<w.length;_++){const N=w[_];N.oldText!==N.newText&&(S[T++]=N)}return S}}}),define(ne[23],ie([0,1]),function(Z,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.recomputeTreeMetadata=e.updateTreeMetadata=e.fixInsert=e.rbDelete=e.rightRotate=e.leftRotate=e.resetSentinel=e.calculateLF=e.calculateSize=e.righttest=e.leftest=e.SENTINEL=e.NodeColor=e.TreeNode=void 0;class O{constructor(o,t){this.piece=o,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==e.SENTINEL)return D(this.right);let o=this;for(;o.parent!==e.SENTINEL&&o.parent.left!==o;)o=o.parent;return o.parent===e.SENTINEL?e.SENTINEL:o.parent}prev(){if(this.left!==e.SENTINEL)return E(this.left);let o=this;for(;o.parent!==e.SENTINEL&&o.parent.right!==o;)o=o.parent;return o.parent===e.SENTINEL?e.SENTINEL:o.parent}detach(){this.parent=null,this.left=null,this.right=null}}e.TreeNode=O;var F;(function(c){c[c.Black=0]="Black",c[c.Red=1]="Red"})(F=e.NodeColor||(e.NodeColor={})),e.SENTINEL=new O(null,0),e.SENTINEL.parent=e.SENTINEL,e.SENTINEL.left=e.SENTINEL,e.SENTINEL.right=e.SENTINEL,e.SENTINEL.color=0;function D(c){for(;c.left!==e.SENTINEL;)c=c.left;return c}e.leftest=D;function E(c){for(;c.right!==e.SENTINEL;)c=c.right;return c}e.righttest=E;function q(c){return c===e.SENTINEL?0:c.size_left+c.piece.length+q(c.right)}e.calculateSize=q;function k(c){return c===e.SENTINEL?0:c.lf_left+c.piece.lineFeedCnt+k(c.right)}e.calculateLF=k;function A(){e.SENTINEL.parent=e.SENTINEL}e.resetSentinel=A;function w(c,o){const t=o.right;t.size_left+=o.size_left+(o.piece?o.piece.length:0),t.lf_left+=o.lf_left+(o.piece?o.piece.lineFeedCnt:0),o.right=t.left,t.left!==e.SENTINEL&&(t.left.parent=o),t.parent=o.parent,o.parent===e.SENTINEL?c.root=t:o.parent.left===o?o.parent.left=t:o.parent.right=t,t.left=o,o.parent=t}e.leftRotate=w;function S(c,o){const t=o.left;o.left=t.right,t.right!==e.SENTINEL&&(t.right.parent=o),t.parent=o.parent,o.size_left-=t.size_left+(t.piece?t.piece.length:0),o.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),o.parent===e.SENTINEL?c.root=t:o===o.parent.right?o.parent.right=t:o.parent.left=t,t.right=o,o.parent=t}e.rightRotate=S;function T(c,o){let t,s;if(o.left===e.SENTINEL?(s=o,t=s.right):o.right===e.SENTINEL?(s=o,t=s.left):(s=D(o.right),t=s.right),s===c.root){c.root=t,t.color=0,o.detach(),A(),c.root.parent=e.SENTINEL;return}const r=s.color===1;if(s===s.parent.left?s.parent.left=t:s.parent.right=t,s===o?(t.parent=s.parent,b(c,t)):(s.parent===o?t.parent=s:t.parent=s.parent,b(c,t),s.left=o.left,s.right=o.right,s.parent=o.parent,s.color=o.color,o===c.root?c.root=s:o===o.parent.left?o.parent.left=s:o.parent.right=s,s.left!==e.SENTINEL&&(s.left.parent=s),s.right!==e.SENTINEL&&(s.right.parent=s),s.size_left=o.size_left,s.lf_left=o.lf_left,b(c,s)),o.detach(),t.parent.left===t){const f=q(t),g=k(t);if(f!==t.parent.size_left||g!==t.parent.lf_left){const C=f-t.parent.size_left,I=g-t.parent.lf_left;t.parent.size_left=f,t.parent.lf_left=g,N(c,t.parent,C,I)}}if(b(c,t.parent),r){A();return}let u;for(;t!==c.root&&t.color===0;)t===t.parent.left?(u=t.parent.right,u.color===1&&(u.color=0,t.parent.color=1,w(c,t.parent),u=t.parent.right),u.left.color===0&&u.right.color===0?(u.color=1,t=t.parent):(u.right.color===0&&(u.left.color=0,u.color=1,S(c,u),u=t.parent.right),u.color=t.parent.color,t.parent.color=0,u.right.color=0,w(c,t.parent),t=c.root)):(u=t.parent.left,u.color===1&&(u.color=0,t.parent.color=1,S(c,t.parent),u=t.parent.left),u.left.color===0&&u.right.color===0?(u.color=1,t=t.parent):(u.left.color===0&&(u.right.color=0,u.color=1,w(c,u),u=t.parent.left),u.color=t.parent.color,t.parent.color=0,u.left.color=0,S(c,t.parent),t=c.root));t.color=0,A()}e.rbDelete=T;function _(c,o){for(b(c,o);o!==c.root&&o.parent.color===1;)if(o.parent===o.parent.parent.left){const t=o.parent.parent.right;t.color===1?(o.parent.color=0,t.color=0,o.parent.parent.color=1,o=o.parent.parent):(o===o.parent.right&&(o=o.parent,w(c,o)),o.parent.color=0,o.parent.parent.color=1,S(c,o.parent.parent))}else{const t=o.parent.parent.left;t.color===1?(o.parent.color=0,t.color=0,o.parent.parent.color=1,o=o.parent.parent):(o===o.parent.left&&(o=o.parent,S(c,o)),o.parent.color=0,o.parent.parent.color=1,w(c,o.parent.parent))}c.root.color=0}e.fixInsert=_;function N(c,o,t,s){for(;o!==c.root&&o!==e.SENTINEL;)o.parent.left===o&&(o.parent.size_left+=t,o.parent.lf_left+=s),o=o.parent}e.updateTreeMetadata=N;function b(c,o){let t=0,s=0;if(o!==c.root){for(;o!==c.root&&o===o.parent.right;)o=o.parent;if(o!==c.root)for(o=o.parent,t=q(o.left)-o.size_left,s=k(o.left)-o.lf_left,o.size_left+=t,o.lf_left+=s;o!==c.root&&(t!==0||s!==0);)o.parent.left===o&&(o.parent.size_left+=t,o.parent.lf_left+=s),o=o.parent}}e.recomputeTreeMetadata=b}),define(ne[10],ie([0,1,33,11,24,23,34]),function(Z,e,O,F,D,E,q){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PieceTreeBase=e.StringBuffer=e.Piece=e.createLineStarts=e.createLineStartsFast=e.LineStarts=e.createUintArray=e.AverageBufferSize=void 0,e.AverageBufferSize=65535;function k(o){let t;return o[o.length-1]<65536?t=new Uint16Array(o.length):t=new Uint32Array(o.length),t.set(o,0),t}e.createUintArray=k;class A{constructor(t,s,r,u,f){this.lineStarts=t,this.cr=s,this.lf=r,this.crlf=u,this.isBasicASCII=f}}e.LineStarts=A;function w(o,t=!0){const s=[0];let r=1;for(let u=0,f=o.length;u<f;u++){const g=o.charCodeAt(u);g===13?u+1<f&&o.charCodeAt(u+1)===10?(s[r++]=u+2,u++):s[r++]=u+1:g===10&&(s[r++]=u+1)}return t?k(s):s}e.createLineStartsFast=w;function S(o,t){o.length=0,o[0]=0;let s=1,r=0,u=0,f=0,g=!0;for(let I=0,M=t.length;I<M;I++){const a=t.charCodeAt(I);a===13?I+1<M&&t.charCodeAt(I+1)===10?(f++,o[s++]=I+2,I++):(r++,o[s++]=I+1):a===10?(u++,o[s++]=I+1):g&&a!==9&&(a<32||a>126)&&(g=!1)}const C=new A(k(o),r,u,f,g);return o.length=0,C}e.createLineStarts=S;class T{constructor(t,s,r,u,f){this.bufferIndex=t,this.start=s,this.end=r,this.lineFeedCnt=u,this.length=f}}e.Piece=T;class _{constructor(t,s){this.buffer=t,this.lineStarts=s}}e.StringBuffer=_;class N{constructor(t,s){this._pieces=[],this._tree=t,this._BOM=s,this._index=0,t.root!==E.SENTINEL&&t.iterate(t.root,r=>(r!==E.SENTINEL&&this._pieces.push(r.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class b{constructor(t){this._limit=t,this._cache=[]}get(t){for(let s=this._cache.length-1;s>=0;s--){const r=this._cache[s];if(r.nodeStartOffset<=t&&r.nodeStartOffset+r.node.piece.length>=t)return r}return null}get2(t){for(let s=this._cache.length-1;s>=0;s--){const r=this._cache[s];if(r.nodeStartLineNumber&&r.nodeStartLineNumber<t&&r.nodeStartLineNumber+r.node.piece.lineFeedCnt>=t)return r}return null}set(t){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(t)}validate(t){let s=!1;const r=this._cache;for(let u=0;u<r.length;u++){const f=r[u];if(f.node.parent===null||f.nodeStartOffset>=t){r[u]=null,s=!0;continue}}if(s){const u=[];for(const f of r)f!==null&&u.push(f);this._cache=u}}}class c{constructor(t,s,r){this.create(t,s,r)}create(t,s,r){this._buffers=[new _("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=E.SENTINEL,this._lineCnt=1,this._length=0,this._EOL=s,this._EOLLength=s.length,this._EOLNormalized=r;let u=null;for(let f=0,g=t.length;f<g;f++)if(t[f].buffer.length>0){t[f].lineStarts||(t[f].lineStarts=w(t[f].buffer));const C=new T(f+1,{line:0,column:0},{line:t[f].lineStarts.length-1,column:t[f].buffer.length-t[f].lineStarts[t[f].lineStarts.length-1]},t[f].lineStarts.length-1,t[f].buffer.length);this._buffers.push(t[f]),u=this.rbInsertRight(u,C)}this._searchCache=new b(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(t){const s=e.AverageBufferSize,r=s-Math.floor(s/3),u=r*2;let f="",g=0;const C=[];if(this.iterate(this.root,I=>{const M=this.getNodeContent(I),a=M.length;if(g<=r||g+a<u)return f+=M,g+=a,!0;const i=f.replace(/\r\n|\r|\n/g,t);return C.push(new _(i,w(i))),f=M,g=a,!0}),g>0){const I=f.replace(/\r\n|\r|\n/g,t);C.push(new _(I,w(I)))}this.create(C,t,!0)}getEOL(){return this._EOL}setEOL(t){this._EOL=t,this._EOLLength=this._EOL.length,this.normalizeEOL(t)}createSnapshot(t){return new N(this,t)}equal(t){if(this.getLength()!==t.getLength()||this.getLineCount()!==t.getLineCount())return!1;const s=0;return this.iterate(this.root,u=>{if(u===E.SENTINEL)return!0;const f=this.getNodeContent(u),g=f.length,C=t.nodeAt(s),I=t.nodeAt(s+g),M=t.getValueInRange2(C,I);return f===M})}getOffsetAt(t,s){let r=0,u=this.root;for(;u!==E.SENTINEL;)if(u.left!==E.SENTINEL&&u.lf_left+1>=t)u=u.left;else{if(u.lf_left+u.piece.lineFeedCnt+1>=t)return r+=u.size_left,r+=this.getAccumulatedValue(u,t-u.lf_left-2)+s-1;t-=u.lf_left+u.piece.lineFeedCnt,r+=u.size_left+u.piece.length,u=u.right}return r}getPositionAt(t){t=Math.floor(t),t=Math.max(0,t);let s=this.root,r=0;const u=t;for(;s!==E.SENTINEL;)if(s.size_left!==0&&s.size_left>=t)s=s.left;else if(s.size_left+s.piece.length>=t){const f=this.getIndexOf(s,t-s.size_left);if(r+=s.lf_left+f.index,f.index===0){const g=this.getOffsetAt(r+1,1),C=u-g;return new O.Position(r+1,C+1)}return new O.Position(r+1,f.remainder+1)}else if(t-=s.size_left+s.piece.length,r+=s.lf_left+s.piece.lineFeedCnt,s.right===E.SENTINEL){const f=this.getOffsetAt(r+1,1),g=u-t-f;return new O.Position(r+1,g+1)}else s=s.right;return new O.Position(1,1)}getValueInRange(t,s){if(t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn)return"";const r=this.nodeAt2(t.startLineNumber,t.startColumn),u=this.nodeAt2(t.endLineNumber,t.endColumn),f=this.getValueInRange2(r,u);return s?s!==this._EOL||!this._EOLNormalized?f.replace(/\r\n|\r|\n/g,s):s===this.getEOL()&&this._EOLNormalized?f:f.replace(/\r\n|\r|\n/g,s):f}getValueInRange2(t,s){if(t.node===s.node){const C=t.node,I=this._buffers[C.piece.bufferIndex].buffer,M=this.offsetInBuffer(C.piece.bufferIndex,C.piece.start);return I.substring(M+t.remainder,M+s.remainder)}let r=t.node;const u=this._buffers[r.piece.bufferIndex].buffer,f=this.offsetInBuffer(r.piece.bufferIndex,r.piece.start);let g=u.substring(f+t.remainder,f+r.piece.length);for(r=r.next();r!==E.SENTINEL;){const C=this._buffers[r.piece.bufferIndex].buffer,I=this.offsetInBuffer(r.piece.bufferIndex,r.piece.start);if(r===s.node){g+=C.substring(I,I+s.remainder);break}else g+=C.substr(I,r.piece.length);r=r.next()}return g}getLinesContent(){const t=[];let s=0,r="",u=!1;return this.iterate(this.root,f=>{if(f===E.SENTINEL)return!0;const g=f.piece;let C=g.length;if(C===0)return!0;const I=this._buffers[g.bufferIndex].buffer,M=this._buffers[g.bufferIndex].lineStarts,a=g.start.line,i=g.end.line;let h=M[a]+g.start.column;if(u&&(I.charCodeAt(h)===10&&(h++,C--),t[s++]=r,r="",u=!1,C===0))return!0;if(a===i)return!this._EOLNormalized&&I.charCodeAt(h+C-1)===13?(u=!0,r+=I.substr(h,C-1)):r+=I.substr(h,C),!0;r+=this._EOLNormalized?I.substring(h,Math.max(h,M[a+1]-this._EOLLength)):I.substring(h,M[a+1]).replace(/(\r\n|\r|\n)$/,""),t[s++]=r;for(let l=a+1;l<i;l++)r=this._EOLNormalized?I.substring(M[l],M[l+1]-this._EOLLength):I.substring(M[l],M[l+1]).replace(/(\r\n|\r|\n)$/,""),t[s++]=r;return!this._EOLNormalized&&I.charCodeAt(M[i]+g.end.column-1)===13?(u=!0,g.end.column===0?s--:r=I.substr(M[i],g.end.column-1)):r=I.substr(M[i],g.end.column),!0}),u&&(t[s++]=r,r=""),t[s++]=r,t}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(t){return this._lastVisitedLine.lineNumber===t?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=t,t===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(t):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(t,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(t).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(t){if(t.remainder===t.node.piece.length){const s=t.node.next();if(!s)return 0;const r=this._buffers[s.piece.bufferIndex],u=this.offsetInBuffer(s.piece.bufferIndex,s.piece.start);return r.buffer.charCodeAt(u)}else{const s=this._buffers[t.node.piece.bufferIndex],u=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start)+t.remainder;return s.buffer.charCodeAt(u)}}getLineCharCode(t,s){const r=this.nodeAt2(t,s+1);return this._getCharCode(r)}getLineLength(t){if(t===this.getLineCount()){const s=this.getOffsetAt(t,1);return this.getLength()-s}return this.getOffsetAt(t+1,1)-this.getOffsetAt(t,1)-this._EOLLength}getCharCode(t){const s=this.nodeAt(t);return this._getCharCode(s)}findMatchesInNode(t,s,r,u,f,g,C,I,M,a,i){const h=this._buffers[t.piece.bufferIndex],l=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start),d=this.offsetInBuffer(t.piece.bufferIndex,f),L=this.offsetInBuffer(t.piece.bufferIndex,g);let U;const z={line:0,column:0};let P,n;s._wordSeparators?(P=h.buffer.substring(d,L),n=p=>p+d,s.reset(0)):(P=h.buffer,n=p=>p,s.reset(d));do if(U=s.next(P),U){if(n(U.index)>=L)return a;this.positionInBuffer(t,n(U.index)-l,z);const p=this.getLineFeedCnt(t.piece.bufferIndex,f,z),v=z.line===f.line?z.column-f.column+u:z.column+1,K=v+U[0].length;if(i[a++]=(0,q.createFindMatch)(new F.Range(r+p,v,r+p,K),U,I),n(U.index)+U[0].length>=L||a>=M)return a}while(U);return a}findMatchesLineByLine(t,s,r,u){const f=[];let g=0;const C=new q.Searcher(s.wordSeparators,s.regex);let I=this.nodeAt2(t.startLineNumber,t.startColumn);if(I===null)return[];const M=this.nodeAt2(t.endLineNumber,t.endColumn);if(M===null)return[];let a=this.positionInBuffer(I.node,I.remainder);const i=this.positionInBuffer(M.node,M.remainder);if(I.node===M.node)return this.findMatchesInNode(I.node,C,t.startLineNumber,t.startColumn,a,i,s,r,u,g,f),f;let h=t.startLineNumber,l=I.node;for(;l!==M.node;){const L=this.getLineFeedCnt(l.piece.bufferIndex,a,l.piece.end);if(L>=1){const z=this._buffers[l.piece.bufferIndex].lineStarts,P=this.offsetInBuffer(l.piece.bufferIndex,l.piece.start),n=z[a.line+L],p=h===t.startLineNumber?t.startColumn:1;if(g=this.findMatchesInNode(l,C,h,p,a,this.positionInBuffer(l,n-P),s,r,u,g,f),g>=u)return f;h+=L}const U=h===t.startLineNumber?t.startColumn-1:0;if(h===t.endLineNumber){const z=this.getLineContent(h).substring(U,t.endColumn-1);return g=this._findMatchesInLine(s,C,z,t.endLineNumber,U,g,f,r,u),f}if(g=this._findMatchesInLine(s,C,this.getLineContent(h).substr(U),h,U,g,f,r,u),g>=u)return f;h++,I=this.nodeAt2(h,1),l=I.node,a=this.positionInBuffer(I.node,I.remainder)}if(h===t.endLineNumber){const L=h===t.startLineNumber?t.startColumn-1:0,U=this.getLineContent(h).substring(L,t.endColumn-1);return g=this._findMatchesInLine(s,C,U,t.endLineNumber,L,g,f,r,u),f}const d=h===t.startLineNumber?t.startColumn:1;return g=this.findMatchesInNode(M.node,C,h,d,a,i,s,r,u,g,f),f}_findMatchesInLine(t,s,r,u,f,g,C,I,M){const a=t.wordSeparators;if(!I&&t.simpleSearch){const h=t.simpleSearch,l=h.length,d=r.length;let L=-l;for(;(L=r.indexOf(h,L+l))!==-1;)if((!a||(0,q.isValidMatch)(a,r,d,L,l))&&(C[g++]=new D.FindMatch(new F.Range(u,L+1+f,u,L+1+l+f),null),g>=M))return g;return g}let i;s.reset(0);do if(i=s.next(r),i&&(C[g++]=(0,q.createFindMatch)(new F.Range(u,i.index+1+f,u,i.index+1+i[0].length+f),i,I),g>=M))return g;while(i);return g}insert(t,s,r=!1){if(this._EOLNormalized=this._EOLNormalized&&r,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==E.SENTINEL){const{node:u,remainder:f,nodeStartOffset:g}=this.nodeAt(t),C=u.piece,I=C.bufferIndex,M=this.positionInBuffer(u,f);if(u.piece.bufferIndex===0&&C.end.line===this._lastChangeBufferPos.line&&C.end.column===this._lastChangeBufferPos.column&&g+C.length===t&&s.length<e.AverageBufferSize){this.appendToNode(u,s),this.computeBufferMetadata();return}if(g===t)this.insertContentToNodeLeft(s,u),this._searchCache.validate(t);else if(g+u.piece.length>t){const a=[];let i=new T(C.bufferIndex,M,C.end,this.getLineFeedCnt(C.bufferIndex,M,C.end),this.offsetInBuffer(I,C.end)-this.offsetInBuffer(I,M));if(this.shouldCheckCRLF()&&this.endWithCR(s)&&this.nodeCharCodeAt(u,f)===10){const L={line:i.start.line+1,column:0};i=new T(i.bufferIndex,L,i.end,this.getLineFeedCnt(i.bufferIndex,L,i.end),i.length-1),s+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(s))if(this.nodeCharCodeAt(u,f-1)===13){const L=this.positionInBuffer(u,f-1);this.deleteNodeTail(u,L),s="\r"+s,u.piece.length===0&&a.push(u)}else this.deleteNodeTail(u,M);else this.deleteNodeTail(u,M);const h=this.createNewPieces(s);i.length>0&&this.rbInsertRight(u,i);let l=u;for(let d=0;d<h.length;d++)l=this.rbInsertRight(l,h[d]);this.deleteNodes(a)}else this.insertContentToNodeRight(s,u)}else{const u=this.createNewPieces(s);let f=this.rbInsertLeft(null,u[0]);for(let g=1;g<u.length;g++)f=this.rbInsertRight(f,u[g])}this.computeBufferMetadata()}delete(t,s){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",s<=0||this.root===E.SENTINEL)return;const r=this.nodeAt(t),u=this.nodeAt(t+s),f=r.node,g=u.node;if(f===g){const h=this.positionInBuffer(f,r.remainder),l=this.positionInBuffer(f,u.remainder);if(r.nodeStartOffset===t){if(s===f.piece.length){const d=f.next();(0,E.rbDelete)(this,f),this.validateCRLFWithPrevNode(d),this.computeBufferMetadata();return}this.deleteNodeHead(f,l),this._searchCache.validate(t),this.validateCRLFWithPrevNode(f),this.computeBufferMetadata();return}if(r.nodeStartOffset+f.piece.length===t+s){this.deleteNodeTail(f,h),this.validateCRLFWithNextNode(f),this.computeBufferMetadata();return}this.shrinkNode(f,h,l),this.computeBufferMetadata();return}const C=[],I=this.positionInBuffer(f,r.remainder);this.deleteNodeTail(f,I),this._searchCache.validate(t),f.piece.length===0&&C.push(f);const M=this.positionInBuffer(g,u.remainder);this.deleteNodeHead(g,M),g.piece.length===0&&C.push(g);const a=f.next();for(let h=a;h!==E.SENTINEL&&h!==g;h=h.next())C.push(h);const i=f.piece.length===0?f.prev():f;this.deleteNodes(C),this.validateCRLFWithNextNode(i),this.computeBufferMetadata()}insertContentToNodeLeft(t,s){const r=[];if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.startWithLF(s)){const g=s.piece,C={line:g.start.line+1,column:0},I=new T(g.bufferIndex,C,g.end,this.getLineFeedCnt(g.bufferIndex,C,g.end),g.length-1);s.piece=I,t+=`
`,(0,E.updateTreeMetadata)(this,s,-1,-1),s.piece.length===0&&r.push(s)}const u=this.createNewPieces(t);let f=this.rbInsertLeft(s,u[u.length-1]);for(let g=u.length-2;g>=0;g--)f=this.rbInsertLeft(f,u[g]);this.validateCRLFWithPrevNode(f),this.deleteNodes(r)}insertContentToNodeRight(t,s){this.adjustCarriageReturnFromNext(t,s)&&(t+=`
`);const r=this.createNewPieces(t),u=this.rbInsertRight(s,r[0]);let f=u;for(let g=1;g<r.length;g++)f=this.rbInsertRight(f,r[g]);this.validateCRLFWithPrevNode(u)}positionInBuffer(t,s,r){const u=t.piece,f=t.piece.bufferIndex,g=this._buffers[f].lineStarts,I=g[u.start.line]+u.start.column+s;let M=u.start.line,a=u.end.line,i=0,h=0,l=0;for(;M<=a&&(i=M+(a-M)/2|0,l=g[i],i!==a);)if(h=g[i+1],I<l)a=i-1;else if(I>=h)M=i+1;else break;return r?(r.line=i,r.column=I-l,null):{line:i,column:I-l}}getLineFeedCnt(t,s,r){if(r.column===0)return r.line-s.line;const u=this._buffers[t].lineStarts;if(r.line===u.length-1)return r.line-s.line;const f=u[r.line+1],g=u[r.line]+r.column;if(f>g+1)return r.line-s.line;const C=g-1;return this._buffers[t].buffer.charCodeAt(C)===13?r.line-s.line+1:r.line-s.line}offsetInBuffer(t,s){return this._buffers[t].lineStarts[s.line]+s.column}deleteNodes(t){for(let s=0;s<t.length;s++)(0,E.rbDelete)(this,t[s])}createNewPieces(t){if(t.length>e.AverageBufferSize){const a=[];for(;t.length>e.AverageBufferSize;){const h=t.charCodeAt(e.AverageBufferSize-1);let l;h===13||h>=55296&&h<=56319?(l=t.substring(0,e.AverageBufferSize-1),t=t.substring(e.AverageBufferSize-1)):(l=t.substring(0,e.AverageBufferSize),t=t.substring(e.AverageBufferSize));const d=w(l);a.push(new T(this._buffers.length,{line:0,column:0},{line:d.length-1,column:l.length-d[d.length-1]},d.length-1,l.length)),this._buffers.push(new _(l,d))}const i=w(t);return a.push(new T(this._buffers.length,{line:0,column:0},{line:i.length-1,column:t.length-i[i.length-1]},i.length-1,t.length)),this._buffers.push(new _(t,i)),a}let s=this._buffers[0].buffer.length;const r=w(t,!1);let u=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===s&&s!==0&&this.startWithLF(t)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},u=this._lastChangeBufferPos;for(let a=0;a<r.length;a++)r[a]+=s+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1)),this._buffers[0].buffer+="_"+t,s+=1}else{if(s!==0)for(let a=0;a<r.length;a++)r[a]+=s;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1)),this._buffers[0].buffer+=t}const f=this._buffers[0].buffer.length,g=this._buffers[0].lineStarts.length-1,C=f-this._buffers[0].lineStarts[g],I={line:g,column:C},M=new T(0,u,I,this.getLineFeedCnt(0,u,I),f-s);return this._lastChangeBufferPos=I,[M]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(t,s=0){let r=this.root,u="";const f=this._searchCache.get2(t);if(f){r=f.node;const g=this.getAccumulatedValue(r,t-f.nodeStartLineNumber-1),C=this._buffers[r.piece.bufferIndex].buffer,I=this.offsetInBuffer(r.piece.bufferIndex,r.piece.start);if(f.nodeStartLineNumber+r.piece.lineFeedCnt===t)u=C.substring(I+g,I+r.piece.length);else{const M=this.getAccumulatedValue(r,t-f.nodeStartLineNumber);return C.substring(I+g,I+M-s)}}else{let g=0;const C=t;for(;r!==E.SENTINEL;)if(r.left!==E.SENTINEL&&r.lf_left>=t-1)r=r.left;else if(r.lf_left+r.piece.lineFeedCnt>t-1){const I=this.getAccumulatedValue(r,t-r.lf_left-2),M=this.getAccumulatedValue(r,t-r.lf_left-1),a=this._buffers[r.piece.bufferIndex].buffer,i=this.offsetInBuffer(r.piece.bufferIndex,r.piece.start);return g+=r.size_left,this._searchCache.set({node:r,nodeStartOffset:g,nodeStartLineNumber:C-(t-1-r.lf_left)}),a.substring(i+I,i+M-s)}else if(r.lf_left+r.piece.lineFeedCnt===t-1){const I=this.getAccumulatedValue(r,t-r.lf_left-2),M=this._buffers[r.piece.bufferIndex].buffer,a=this.offsetInBuffer(r.piece.bufferIndex,r.piece.start);u=M.substring(a+I,a+r.piece.length);break}else t-=r.lf_left+r.piece.lineFeedCnt,g+=r.size_left+r.piece.length,r=r.right}for(r=r.next();r!==E.SENTINEL;){const g=this._buffers[r.piece.bufferIndex].buffer;if(r.piece.lineFeedCnt>0){const C=this.getAccumulatedValue(r,0),I=this.offsetInBuffer(r.piece.bufferIndex,r.piece.start);return u+=g.substring(I,I+C-s),u}else{const C=this.offsetInBuffer(r.piece.bufferIndex,r.piece.start);u+=g.substr(C,r.piece.length)}r=r.next()}return u}computeBufferMetadata(){let t=this.root,s=1,r=0;for(;t!==E.SENTINEL;)s+=t.lf_left+t.piece.lineFeedCnt,r+=t.size_left+t.piece.length,t=t.right;this._lineCnt=s,this._length=r,this._searchCache.validate(this._length)}getIndexOf(t,s){const r=t.piece,u=this.positionInBuffer(t,s),f=u.line-r.start.line;if(this.offsetInBuffer(r.bufferIndex,r.end)-this.offsetInBuffer(r.bufferIndex,r.start)===s){const g=this.getLineFeedCnt(t.piece.bufferIndex,r.start,u);if(g!==f)return{index:g,remainder:0}}return{index:f,remainder:u.column}}getAccumulatedValue(t,s){if(s<0)return 0;const r=t.piece,u=this._buffers[r.bufferIndex].lineStarts,f=r.start.line+s+1;return f>r.end.line?u[r.end.line]+r.end.column-u[r.start.line]-r.start.column:u[f]-u[r.start.line]-r.start.column}deleteNodeTail(t,s){const r=t.piece,u=r.lineFeedCnt,f=this.offsetInBuffer(r.bufferIndex,r.end),g=s,C=this.offsetInBuffer(r.bufferIndex,g),I=this.getLineFeedCnt(r.bufferIndex,r.start,g),M=I-u,a=C-f,i=r.length+a;t.piece=new T(r.bufferIndex,r.start,g,I,i),(0,E.updateTreeMetadata)(this,t,a,M)}deleteNodeHead(t,s){const r=t.piece,u=r.lineFeedCnt,f=this.offsetInBuffer(r.bufferIndex,r.start),g=s,C=this.getLineFeedCnt(r.bufferIndex,g,r.end),I=this.offsetInBuffer(r.bufferIndex,g),M=C-u,a=f-I,i=r.length+a;t.piece=new T(r.bufferIndex,g,r.end,C,i),(0,E.updateTreeMetadata)(this,t,a,M)}shrinkNode(t,s,r){const u=t.piece,f=u.start,g=u.end,C=u.length,I=u.lineFeedCnt,M=s,a=this.getLineFeedCnt(u.bufferIndex,u.start,M),i=this.offsetInBuffer(u.bufferIndex,s)-this.offsetInBuffer(u.bufferIndex,f);t.piece=new T(u.bufferIndex,u.start,M,a,i),(0,E.updateTreeMetadata)(this,t,i-C,a-I);const h=new T(u.bufferIndex,r,g,this.getLineFeedCnt(u.bufferIndex,r,g),this.offsetInBuffer(u.bufferIndex,g)-this.offsetInBuffer(u.bufferIndex,r)),l=this.rbInsertRight(t,h);this.validateCRLFWithPrevNode(l)}appendToNode(t,s){this.adjustCarriageReturnFromNext(s,t)&&(s+=`
`);const r=this.shouldCheckCRLF()&&this.startWithLF(s)&&this.endWithCR(t),u=this._buffers[0].buffer.length;this._buffers[0].buffer+=s;const f=w(s,!1);for(let l=0;l<f.length;l++)f[l]+=u;if(r){const l=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:u-l}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(f.slice(1));const g=this._buffers[0].lineStarts.length-1,C=this._buffers[0].buffer.length-this._buffers[0].lineStarts[g],I={line:g,column:C},M=t.piece.length+s.length,a=t.piece.lineFeedCnt,i=this.getLineFeedCnt(0,t.piece.start,I),h=i-a;t.piece=new T(t.piece.bufferIndex,t.piece.start,I,i,M),this._lastChangeBufferPos=I,(0,E.updateTreeMetadata)(this,t,s.length,h)}nodeAt(t){let s=this.root;const r=this._searchCache.get(t);if(r)return{node:r.node,nodeStartOffset:r.nodeStartOffset,remainder:t-r.nodeStartOffset};let u=0;for(;s!==E.SENTINEL;)if(s.size_left>t)s=s.left;else if(s.size_left+s.piece.length>=t){u+=s.size_left;const f={node:s,remainder:t-s.size_left,nodeStartOffset:u};return this._searchCache.set(f),f}else t-=s.size_left+s.piece.length,u+=s.size_left+s.piece.length,s=s.right;return null}nodeAt2(t,s){let r=this.root,u=0;for(;r!==E.SENTINEL;)if(r.left!==E.SENTINEL&&r.lf_left>=t-1)r=r.left;else if(r.lf_left+r.piece.lineFeedCnt>t-1){const f=this.getAccumulatedValue(r,t-r.lf_left-2),g=this.getAccumulatedValue(r,t-r.lf_left-1);return u+=r.size_left,{node:r,remainder:Math.min(f+s-1,g),nodeStartOffset:u}}else if(r.lf_left+r.piece.lineFeedCnt===t-1){const f=this.getAccumulatedValue(r,t-r.lf_left-2);if(f+s-1<=r.piece.length)return{node:r,remainder:f+s-1,nodeStartOffset:u};s-=r.piece.length-f;break}else t-=r.lf_left+r.piece.lineFeedCnt,u+=r.size_left+r.piece.length,r=r.right;for(r=r.next();r!==E.SENTINEL;){if(r.piece.lineFeedCnt>0){const f=this.getAccumulatedValue(r,0),g=this.offsetOfNode(r);return{node:r,remainder:Math.min(s-1,f),nodeStartOffset:g}}else if(r.piece.length>=s-1){const f=this.offsetOfNode(r);return{node:r,remainder:s-1,nodeStartOffset:f}}else s-=r.piece.length;r=r.next()}return null}nodeCharCodeAt(t,s){if(t.piece.lineFeedCnt<1)return-1;const r=this._buffers[t.piece.bufferIndex],u=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start)+s;return r.buffer.charCodeAt(u)}offsetOfNode(t){if(!t)return 0;let s=t.size_left;for(;t!==this.root;)t.parent.right===t&&(s+=t.parent.size_left+t.parent.piece.length),t=t.parent;return s}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(t){if(typeof t=="string")return t.charCodeAt(0)===10;if(t===E.SENTINEL||t.piece.lineFeedCnt===0)return!1;const s=t.piece,r=this._buffers[s.bufferIndex].lineStarts,u=s.start.line,f=r[u]+s.start.column;return u===r.length-1||r[u+1]>f+1?!1:this._buffers[s.bufferIndex].buffer.charCodeAt(f)===10}endWithCR(t){return typeof t=="string"?t.charCodeAt(t.length-1)===13:t===E.SENTINEL||t.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(t,t.piece.length-1)===13}validateCRLFWithPrevNode(t){if(this.shouldCheckCRLF()&&this.startWithLF(t)){const s=t.prev();this.endWithCR(s)&&this.fixCRLF(s,t)}}validateCRLFWithNextNode(t){if(this.shouldCheckCRLF()&&this.endWithCR(t)){const s=t.next();this.startWithLF(s)&&this.fixCRLF(t,s)}}fixCRLF(t,s){const r=[],u=this._buffers[t.piece.bufferIndex].lineStarts;let f;t.piece.end.column===0?f={line:t.piece.end.line-1,column:u[t.piece.end.line]-u[t.piece.end.line-1]-1}:f={line:t.piece.end.line,column:t.piece.end.column-1};const g=t.piece.length-1,C=t.piece.lineFeedCnt-1;t.piece=new T(t.piece.bufferIndex,t.piece.start,f,C,g),(0,E.updateTreeMetadata)(this,t,-1,-1),t.piece.length===0&&r.push(t);const I={line:s.piece.start.line+1,column:0},M=s.piece.length-1,a=this.getLineFeedCnt(s.piece.bufferIndex,I,s.piece.end);s.piece=new T(s.piece.bufferIndex,I,s.piece.end,a,M),(0,E.updateTreeMetadata)(this,s,-1,-1),s.piece.length===0&&r.push(s);const i=this.createNewPieces(`\r
`);this.rbInsertRight(t,i[0]);for(let h=0;h<r.length;h++)(0,E.rbDelete)(this,r[h])}adjustCarriageReturnFromNext(t,s){if(this.shouldCheckCRLF()&&this.endWithCR(t)){const r=s.next();if(this.startWithLF(r)){if(t+=`
`,r.piece.length===1)(0,E.rbDelete)(this,r);else{const u=r.piece,f={line:u.start.line+1,column:0},g=u.length-1,C=this.getLineFeedCnt(u.bufferIndex,f,u.end);r.piece=new T(u.bufferIndex,f,u.end,C,g),(0,E.updateTreeMetadata)(this,r,-1,-1)}return!0}}return!1}iterate(t,s){if(t===E.SENTINEL)return s(E.SENTINEL);const r=this.iterate(t.left,s);return r&&s(t)&&this.iterate(t.right,s)}getNodeContent(t){if(t===E.SENTINEL)return"";const s=this._buffers[t.piece.bufferIndex];let r;const u=t.piece,f=this.offsetInBuffer(u.bufferIndex,u.start),g=this.offsetInBuffer(u.bufferIndex,u.end);return r=s.buffer.substring(f,g),r}getPieceContent(t){const s=this._buffers[t.bufferIndex],r=this.offsetInBuffer(t.bufferIndex,t.start),u=this.offsetInBuffer(t.bufferIndex,t.end);return s.buffer.substring(r,u)}rbInsertRight(t,s){const r=new E.TreeNode(s,1);if(r.left=E.SENTINEL,r.right=E.SENTINEL,r.parent=E.SENTINEL,r.size_left=0,r.lf_left=0,this.root===E.SENTINEL)this.root=r,r.color=0;else if(t.right===E.SENTINEL)t.right=r,r.parent=t;else{const f=(0,E.leftest)(t.right);f.left=r,r.parent=f}return(0,E.fixInsert)(this,r),r}rbInsertLeft(t,s){const r=new E.TreeNode(s,1);if(r.left=E.SENTINEL,r.right=E.SENTINEL,r.parent=E.SENTINEL,r.size_left=0,r.lf_left=0,this.root===E.SENTINEL)this.root=r,r.color=0;else if(t.left===E.SENTINEL)t.left=r,r.parent=t;else{const u=(0,E.righttest)(t.left);u.right=r,r.parent=u}return(0,E.fixInsert)(this,r),r}getContentOfSubTree(t){let s="";return this.iterate(t,r=>(s+=this.getNodeContent(r),!0)),s}}e.PieceTreeBase=c}),define(ne[25],ie([0,1,18,2,11,24,10,20,22,5]),function(Z,e,O,F,D,E,q,k,A,w){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PieceTreeTextBuffer=void 0;class S extends w.Disposable{constructor(_,N,b,c,o,t,s){super();this._onDidChangeContent=this._register(new O.Emitter),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=N,this._mightContainNonBasicASCII=!t,this._mightContainRTL=c,this._mightContainUnusualLineTerminators=o,this._pieceTree=new q.PieceTreeBase(_,b,s)}equals(_){return!(_ instanceof S)||this._BOM!==_._BOM||this.getEOL()!==_.getEOL()?!1:this._pieceTree.equal(_._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(_){return this._pieceTree.createSnapshot(_?this._BOM:"")}getOffsetAt(_,N){return this._pieceTree.getOffsetAt(_,N)}getPositionAt(_){return this._pieceTree.getPositionAt(_)}getRangeAt(_,N){const b=_+N,c=this.getPositionAt(_),o=this.getPositionAt(b);return new D.Range(c.lineNumber,c.column,o.lineNumber,o.column)}getValueInRange(_,N=0){if(_.isEmpty())return"";const b=this._getEndOfLine(N);return this._pieceTree.getValueInRange(_,b)}getValueLengthInRange(_,N=0){if(_.isEmpty())return 0;if(_.startLineNumber===_.endLineNumber)return _.endColumn-_.startColumn;const b=this.getOffsetAt(_.startLineNumber,_.startColumn);return this.getOffsetAt(_.endLineNumber,_.endColumn)-b}getCharacterCountInRange(_,N=0){if(this._mightContainNonBasicASCII){let b=0;const c=_.startLineNumber,o=_.endLineNumber;for(let t=c;t<=o;t++){const s=this.getLineContent(t),r=t===c?_.startColumn-1:0,u=t===o?_.endColumn-1:s.length;for(let f=r;f<u;f++)F.isHighSurrogate(s.charCodeAt(f))?(b=b+1,f=f+1):b=b+1}return b+=this._getEndOfLine(N).length*(o-c),b}return this.getValueLengthInRange(_,N)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(_){return this._pieceTree.getLineContent(_)}getLineCharCode(_,N){return this._pieceTree.getLineCharCode(_,N)}getCharCode(_){return this._pieceTree.getCharCode(_)}getLineLength(_){return this._pieceTree.getLineLength(_)}getLineMinColumn(_){return 1}getLineMaxColumn(_){return this.getLineLength(_)+1}getLineFirstNonWhitespaceColumn(_){const N=F.firstNonWhitespaceIndex(this.getLineContent(_));return N===-1?0:N+1}getLineLastNonWhitespaceColumn(_){const N=F.lastNonWhitespaceIndex(this.getLineContent(_));return N===-1?0:N+2}_getEndOfLine(_){switch(_){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(_){this._pieceTree.setEOL(_)}applyEdits(_,N,b){let c=this._mightContainRTL,o=this._mightContainUnusualLineTerminators,t=this._mightContainNonBasicASCII,s=!0,r=[];for(let a=0;a<_.length;a++){const i=_[a];s&&i._isTracked&&(s=!1);const h=i.range;if(i.text){let z=!0;t||(z=!F.isBasicASCII(i.text),t=z),!c&&z&&(c=F.containsRTL(i.text)),!o&&z&&(o=F.containsUnusualLineTerminators(i.text))}let l="",d=0,L=0,U=0;if(i.text){let z;[d,L,U,z]=(0,k.countEOL)(i.text);const P=this.getEOL();z===0||z===(P===`\r
`?2:1)?l=i.text:l=i.text.replace(/\r\n|\r|\n/g,P)}r[a]={sortIndex:a,identifier:i.identifier||null,range:h,rangeOffset:this.getOffsetAt(h.startLineNumber,h.startColumn),rangeLength:this.getValueLengthInRange(h),text:l,eolCount:d,firstLineLength:L,lastLineLength:U,forceMoveMarkers:Boolean(i.forceMoveMarkers),isAutoWhitespaceEdit:i.isAutoWhitespaceEdit||!1}}r.sort(S._sortOpsAscending);let u=!1;for(let a=0,i=r.length-1;a<i;a++){const h=r[a].range.getEndPosition(),l=r[a+1].range.getStartPosition();if(l.isBeforeOrEqual(h)){if(l.isBefore(h))throw new Error("Overlapping ranges are not allowed!");u=!0}}s&&(r=this._reduceOperations(r));const f=b||N?S._getInverseEditRanges(r):[],g=[];if(N)for(let a=0;a<r.length;a++){const i=r[a],h=f[a];if(i.isAutoWhitespaceEdit&&i.range.isEmpty())for(let l=h.startLineNumber;l<=h.endLineNumber;l++){let d="";l===h.startLineNumber&&(d=this.getLineContent(i.range.startLineNumber),F.firstNonWhitespaceIndex(d)!==-1)||g.push({lineNumber:l,oldContent:d})}}let C=null;if(b){let a=0;C=[];for(let i=0;i<r.length;i++){const h=r[i],l=f[i],d=this.getValueInRange(h.range),L=h.rangeOffset+a;a+=h.text.length-d.length,C[i]={sortIndex:h.sortIndex,identifier:h.identifier,range:l,text:d,textChange:new A.TextChange(h.rangeOffset,d,L,h.text)}}u||C.sort((i,h)=>i.sortIndex-h.sortIndex)}this._mightContainRTL=c,this._mightContainUnusualLineTerminators=o,this._mightContainNonBasicASCII=t;const I=this._doApplyEdits(r);let M=null;if(N&&g.length>0){g.sort((a,i)=>i.lineNumber-a.lineNumber),M=[];for(let a=0,i=g.length;a<i;a++){const h=g[a].lineNumber;if(a>0&&g[a-1].lineNumber===h)continue;const l=g[a].oldContent,d=this.getLineContent(h);d.length===0||d===l||F.firstNonWhitespaceIndex(d)!==-1||M.push(h)}}return this._onDidChangeContent.fire(),new E.ApplyEditsResult(C,I,M)}_reduceOperations(_){return _.length<1e3?_:[this._toSingleEditOperation(_)]}_toSingleEditOperation(_){let N=!1;const b=_[0].range,c=_[_.length-1].range,o=new D.Range(b.startLineNumber,b.startColumn,c.endLineNumber,c.endColumn);let t=b.startLineNumber,s=b.startColumn;const r=[];for(let I=0,M=_.length;I<M;I++){const a=_[I],i=a.range;N=N||a.forceMoveMarkers,r.push(this.getValueInRange(new D.Range(t,s,i.startLineNumber,i.startColumn))),a.text.length>0&&r.push(a.text),t=i.endLineNumber,s=i.endColumn}const u=r.join(""),[f,g,C]=(0,k.countEOL)(u);return{sortIndex:0,identifier:_[0].identifier,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o,0),text:u,eolCount:f,firstLineLength:g,lastLineLength:C,forceMoveMarkers:N,isAutoWhitespaceEdit:!1}}_doApplyEdits(_){_.sort(S._sortOpsDescending);const N=[];for(let b=0;b<_.length;b++){const c=_[b],o=c.range.startLineNumber,t=c.range.startColumn,s=c.range.endLineNumber,r=c.range.endColumn;if(o===s&&t===r&&c.text.length===0)continue;c.text?(this._pieceTree.delete(c.rangeOffset,c.rangeLength),this._pieceTree.insert(c.rangeOffset,c.text,!0)):this._pieceTree.delete(c.rangeOffset,c.rangeLength);const u=new D.Range(o,t,s,r);N.push({range:u,rangeLength:c.rangeLength,text:c.text,rangeOffset:c.rangeOffset,forceMoveMarkers:c.forceMoveMarkers})}return N}findMatchesLineByLine(_,N,b,c){return this._pieceTree.findMatchesLineByLine(_,N,b,c)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(_,N){const b=_.startLineNumber,c=_.startColumn,[o,t,s]=(0,k.countEOL)(N);let r;if(N.length>0){const u=o+1;u===1?r=new D.Range(b,c,b,c+t):r=new D.Range(b,c,b+u-1,s+1)}else r=new D.Range(b,c,b,c);return r}static _getInverseEditRanges(_){const N=[];let b=0,c=0,o=null;for(let t=0,s=_.length;t<s;t++){const r=_[t];let u,f;o?o.range.endLineNumber===r.range.startLineNumber?(u=b,f=c+(r.range.startColumn-o.range.endColumn)):(u=b+(r.range.startLineNumber-o.range.endLineNumber),f=r.range.startColumn):(u=r.range.startLineNumber,f=r.range.startColumn);let g;if(r.text.length>0){const C=r.eolCount+1;C===1?g=new D.Range(u,f,u,f+r.firstLineLength):g=new D.Range(u,f,u+C-1,r.lastLineLength+1)}else g=new D.Range(u,f,u,f);b=g.endLineNumber,c=g.endColumn,N.push(g),o=r}return N}static _sortOpsAscending(_,N){const b=D.Range.compareRangesUsingEnds(_.range,N.range);return b===0?_.sortIndex-N.sortIndex:b}static _sortOpsDescending(_,N){const b=D.Range.compareRangesUsingEnds(_.range,N.range);return b===0?N.sortIndex-_.sortIndex:-b}}e.PieceTreeTextBuffer=S}),define(ne[26],ie([0,1,2,10,25]),function(Z,e,O,F,D){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PieceTreeTextBufferBuilder=e.PieceTreeTextBufferFactory=void 0;class E{constructor(A,w,S,T,_,N,b,c,o){this._chunks=A,this._bom=w,this._cr=S,this._lf=T,this._crlf=_,this._containsRTL=N,this._containsUnusualLineTerminators=b,this._isBasicASCII=c,this._normalizeEOL=o}_getEOL(A){const w=this._cr+this._lf+this._crlf,S=this._cr+this._crlf;return w===0?A===1?`
`:`\r
`:S>w/2?`\r
`:`
`}create(A){const w=this._getEOL(A),S=this._chunks;if(this._normalizeEOL&&(w===`\r
`&&(this._cr>0||this._lf>0)||w===`
`&&(this._cr>0||this._crlf>0)))for(let _=0,N=S.length;_<N;_++){const b=S[_].buffer.replace(/\r\n|\r|\n/g,w),c=(0,F.createLineStartsFast)(b);S[_]=new F.StringBuffer(b,c)}const T=new D.PieceTreeTextBuffer(S,this._bom,w,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:T,disposable:T}}getFirstLineText(A){return this._chunks[0].buffer.substr(0,A).split(/\r\n|\r|\n/)[0]}}e.PieceTreeTextBufferFactory=E;class q{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(A){if(A.length===0)return;this.chunks.length===0&&O.startsWithUTF8BOM(A)&&(this.BOM=O.UTF8_BOM_CHARACTER,A=A.substr(1));const w=A.charCodeAt(A.length-1);w===13||w>=55296&&w<=56319?(this._acceptChunk1(A.substr(0,A.length-1),!1),this._hasPreviousChar=!0,this._previousChar=w):(this._acceptChunk1(A,!1),this._hasPreviousChar=!1,this._previousChar=w)}_acceptChunk1(A,w){!w&&A.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+A):this._acceptChunk2(A))}_acceptChunk2(A){const w=(0,F.createLineStarts)(this._tmpLineStarts,A);this.chunks.push(new F.StringBuffer(A,w.lineStarts)),this.cr+=w.cr,this.lf+=w.lf,this.crlf+=w.crlf,this.isBasicASCII&&(this.isBasicASCII=w.isBasicASCII),!this.isBasicASCII&&!this.containsRTL&&(this.containsRTL=O.containsRTL(A)),!this.isBasicASCII&&!this.containsUnusualLineTerminators&&(this.containsUnusualLineTerminators=O.containsUnusualLineTerminators(A))}finish(A=!0){return this._finish(),new E(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,A)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const A=this.chunks[this.chunks.length-1];A.buffer+=String.fromCharCode(this._previousChar);const w=(0,F.createLineStartsFast)(A.buffer);A.lineStarts=w,this._previousChar===13&&this.cr++}}}e.PieceTreeTextBufferBuilder=q}),define(ne[27],ie([0,1]),function(Z,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.refineServiceDecorator=e.createDecorator=e.IInstantiationService=e._util=void 0;var O;(function(q){q.serviceIds=new Map,q.DI_TARGET="$di$target",q.DI_DEPENDENCIES="$di$dependencies";function k(A){return A[q.DI_DEPENDENCIES]||[]}q.getServiceDependencies=k})(O=e._util||(e._util={})),e.IInstantiationService=D("instantiationService");function F(q,k,A){k[O.DI_TARGET]===k?k[O.DI_DEPENDENCIES].push({id:q,index:A}):(k[O.DI_DEPENDENCIES]=[{id:q,index:A}],k[O.DI_TARGET]=k)}function D(q){if(O.serviceIds.has(q))return O.serviceIds.get(q);const k=function(A,w,S){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");F(k,A,S)};return k.toString=()=>q,O.serviceIds.set(q,k),k}e.createDecorator=D;function E(q){return q}e.refineServiceDecorator=E}),define(ne[28],ie([0,1,3,2,27]),function(Z,e,O,F,D){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.implies=e.SET_CONTEXT_COMMAND_ID=e.IContextKeyService=e.RawContextKey=e.ContextKeyNotRegexExpr=e.ContextKeyRegexExpr=e.ContextKeySmallerEqualsExpr=e.ContextKeySmallerExpr=e.ContextKeyGreaterEqualsExpr=e.ContextKeyGreaterExpr=e.ContextKeyNotExpr=e.ContextKeyNotEqualsExpr=e.ContextKeyNotInExpr=e.ContextKeyInExpr=e.ContextKeyEqualsExpr=e.ContextKeyDefinedExpr=e.ContextKeyTrueExpr=e.ContextKeyFalseExpr=e.expressionsAreEqualWithConstantSubstitution=e.ContextKeyExpr=e.ContextKeyExprType=void 0;const E=new Map;E.set("false",!1),E.set("true",!0),E.set("isMac",O.isMacintosh),E.set("isLinux",O.isLinux),E.set("isWindows",O.isWindows),E.set("isWeb",O.isWeb),E.set("isMacNative",O.isMacintosh&&!O.isWeb),E.set("isEdge",O.isEdge),E.set("isFirefox",O.isFirefox),E.set("isChrome",O.isChrome),E.set("isSafari",O.isSafari);const q=Object.prototype.hasOwnProperty;var k;(function(P){P[P.False=0]="False",P[P.True=1]="True",P[P.Defined=2]="Defined",P[P.Not=3]="Not",P[P.Equals=4]="Equals",P[P.NotEquals=5]="NotEquals",P[P.And=6]="And",P[P.Regex=7]="Regex",P[P.NotRegex=8]="NotRegex",P[P.Or=9]="Or",P[P.In=10]="In",P[P.NotIn=11]="NotIn",P[P.Greater=12]="Greater",P[P.GreaterEquals=13]="GreaterEquals",P[P.Smaller=14]="Smaller",P[P.SmallerEquals=15]="SmallerEquals"})(k=e.ContextKeyExprType||(e.ContextKeyExprType={}));class A{static false(){return T.INSTANCE}static true(){return _.INSTANCE}static has(n){return N.create(n)}static equals(n,p){return b.create(n,p)}static notEquals(n,p){return t.create(n,p)}static regex(n,p){return I.create(n,p)}static in(n,p){return c.create(n,p)}static not(n){return s.create(n)}static and(...n){return i.create(n,null)}static or(...n){return h.create(n,null,!0)}static greater(n,p){return u.create(n,p)}static greaterEquals(n,p){return f.create(n,p)}static smaller(n,p){return g.create(n,p)}static smallerEquals(n,p){return C.create(n,p)}static deserialize(n,p=!1){if(!!n)return this._deserializeOrExpression(n,p)}static _deserializeOrExpression(n,p){let v=n.split("||");return h.create(v.map(K=>this._deserializeAndExpression(K,p)),null,!0)}static _deserializeAndExpression(n,p){let v=n.split("&&");return i.create(v.map(K=>this._deserializeOne(K,p)),null)}static _deserializeOne(n,p){if(n=n.trim(),n.indexOf("!=")>=0){let v=n.split("!=");return t.create(v[0].trim(),this._deserializeValue(v[1],p))}if(n.indexOf("==")>=0){let v=n.split("==");return b.create(v[0].trim(),this._deserializeValue(v[1],p))}if(n.indexOf("=~")>=0){let v=n.split("=~");return I.create(v[0].trim(),this._deserializeRegexValue(v[1],p))}if(n.indexOf(" in ")>=0){let v=n.split(" in ");return c.create(v[0].trim(),v[1].trim())}if(/^[^<=>]+>=[^<=>]+$/.test(n)){const v=n.split(">=");return f.create(v[0].trim(),v[1].trim())}if(/^[^<=>]+>[^<=>]+$/.test(n)){const v=n.split(">");return u.create(v[0].trim(),v[1].trim())}if(/^[^<=>]+<=[^<=>]+$/.test(n)){const v=n.split("<=");return C.create(v[0].trim(),v[1].trim())}if(/^[^<=>]+<[^<=>]+$/.test(n)){const v=n.split("<");return g.create(v[0].trim(),v[1].trim())}return/^\!\s*/.test(n)?s.create(n.substr(1).trim()):N.create(n)}static _deserializeValue(n,p){if(n=n.trim(),n==="true")return!0;if(n==="false")return!1;let v=/^'([^']*)'$/.exec(n);return v?v[1].trim():n}static _deserializeRegexValue(n,p){if((0,F.isFalsyOrWhitespace)(n)){if(p)throw new Error("missing regexp-value for =~-expression");return console.warn("missing regexp-value for =~-expression"),null}let v=n.indexOf("/"),K=n.lastIndexOf("/");if(v===K||v<0){if(p)throw new Error(`bad regexp-value '${n}', missing /-enclosure`);return console.warn(`bad regexp-value '${n}', missing /-enclosure`),null}let X=n.slice(v+1,K),W=n[K+1]==="i"?"i":"";try{return new RegExp(X,W)}catch(j){if(p)throw new Error(`bad regexp-value '${n}', parse error: ${j}`);return console.warn(`bad regexp-value '${n}', parse error: ${j}`),null}}}e.ContextKeyExpr=A;function w(P,n){const p=P?P.substituteConstants():void 0,v=n?n.substituteConstants():void 0;return!p&&!v?!0:!p||!v?!1:p.equals(v)}e.expressionsAreEqualWithConstantSubstitution=w;function S(P,n){return P.cmp(n)}class T{constructor(){this.type=0}cmp(n){return this.type-n.type}equals(n){return n.type===this.type}substituteConstants(){return this}evaluate(n){return!1}serialize(){return"false"}keys(){return[]}map(n){return this}negate(){return _.INSTANCE}}e.ContextKeyFalseExpr=T,T.INSTANCE=new T;class _{constructor(){this.type=1}cmp(n){return this.type-n.type}equals(n){return n.type===this.type}substituteConstants(){return this}evaluate(n){return!0}serialize(){return"true"}keys(){return[]}map(n){return this}negate(){return T.INSTANCE}}e.ContextKeyTrueExpr=_,_.INSTANCE=new _;class N{constructor(n,p){this.key=n,this.negated=p,this.type=2}static create(n,p=null){const v=E.get(n);return typeof v=="boolean"?v?_.INSTANCE:T.INSTANCE:new N(n,p)}cmp(n){return n.type!==this.type?this.type-n.type:d(this.key,n.key)}equals(n){return n.type===this.type?this.key===n.key:!1}substituteConstants(){const n=E.get(this.key);return typeof n=="boolean"?n?_.INSTANCE:T.INSTANCE:this}evaluate(n){return!!n.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(n){return n.mapDefined(this.key)}negate(){return this.negated||(this.negated=s.create(this.key,this)),this.negated}}e.ContextKeyDefinedExpr=N;class b{constructor(n,p,v){this.key=n,this.value=p,this.negated=v,this.type=4}static create(n,p,v=null){if(typeof p=="boolean")return p?N.create(n,v):s.create(n,v);const K=E.get(n);return typeof K=="boolean"?p===(K?"true":"false")?_.INSTANCE:T.INSTANCE:new b(n,p,v)}cmp(n){return n.type!==this.type?this.type-n.type:L(this.key,this.value,n.key,n.value)}equals(n){return n.type===this.type?this.key===n.key&&this.value===n.value:!1}substituteConstants(){const n=E.get(this.key);if(typeof n=="boolean"){const p=n?"true":"false";return this.value===p?_.INSTANCE:T.INSTANCE}return this}evaluate(n){return n.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(n){return n.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=t.create(this.key,this.value,this)),this.negated}}e.ContextKeyEqualsExpr=b;class c{constructor(n,p){this.key=n,this.valueKey=p,this.type=10,this.negated=null}static create(n,p){return new c(n,p)}cmp(n){return n.type!==this.type?this.type-n.type:L(this.key,this.valueKey,n.key,n.valueKey)}equals(n){return n.type===this.type?this.key===n.key&&this.valueKey===n.valueKey:!1}substituteConstants(){return this}evaluate(n){const p=n.getValue(this.valueKey),v=n.getValue(this.key);return Array.isArray(p)?p.indexOf(v)>=0:typeof v=="string"&&typeof p=="object"&&p!==null?q.call(p,v):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(n){return n.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=o.create(this)),this.negated}}e.ContextKeyInExpr=c;class o{constructor(n){this._actual=n,this.type=11}static create(n){return new o(n)}cmp(n){return n.type!==this.type?this.type-n.type:this._actual.cmp(n._actual)}equals(n){return n.type===this.type?this._actual.equals(n._actual):!1}substituteConstants(){return this}evaluate(n){return!this._actual.evaluate(n)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}map(n){return new o(this._actual.map(n))}negate(){return this._actual}}e.ContextKeyNotInExpr=o;class t{constructor(n,p,v){this.key=n,this.value=p,this.negated=v,this.type=5}static create(n,p,v=null){if(typeof p=="boolean")return p?s.create(n,v):N.create(n,v);const K=E.get(n);return typeof K=="boolean"?p===(K?"true":"false")?T.INSTANCE:_.INSTANCE:new t(n,p,v)}cmp(n){return n.type!==this.type?this.type-n.type:L(this.key,this.value,n.key,n.value)}equals(n){return n.type===this.type?this.key===n.key&&this.value===n.value:!1}substituteConstants(){const n=E.get(this.key);if(typeof n=="boolean"){const p=n?"true":"false";return this.value===p?T.INSTANCE:_.INSTANCE}return this}evaluate(n){return n.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(n){return n.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=b.create(this.key,this.value,this)),this.negated}}e.ContextKeyNotEqualsExpr=t;class s{constructor(n,p){this.key=n,this.negated=p,this.type=3}static create(n,p=null){const v=E.get(n);return typeof v=="boolean"?v?T.INSTANCE:_.INSTANCE:new s(n,p)}cmp(n){return n.type!==this.type?this.type-n.type:d(this.key,n.key)}equals(n){return n.type===this.type?this.key===n.key:!1}substituteConstants(){const n=E.get(this.key);return typeof n=="boolean"?n?T.INSTANCE:_.INSTANCE:this}evaluate(n){return!n.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(n){return n.mapNot(this.key)}negate(){return this.negated||(this.negated=N.create(this.key,this)),this.negated}}e.ContextKeyNotExpr=s;function r(P,n){if(typeof P=="string"){const p=parseFloat(P);isNaN(p)||(P=p)}return typeof P=="string"||typeof P=="number"?n(P):T.INSTANCE}class u{constructor(n,p,v){this.key=n,this.value=p,this.negated=v,this.type=12}static create(n,p,v=null){return r(p,K=>new u(n,K,v))}cmp(n){return n.type!==this.type?this.type-n.type:L(this.key,this.value,n.key,n.value)}equals(n){return n.type===this.type?this.key===n.key&&this.value===n.value:!1}substituteConstants(){return this}evaluate(n){return typeof this.value=="string"?!1:parseFloat(n.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(n){return n.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=C.create(this.key,this.value,this)),this.negated}}e.ContextKeyGreaterExpr=u;class f{constructor(n,p,v){this.key=n,this.value=p,this.negated=v,this.type=13}static create(n,p,v=null){return r(p,K=>new f(n,K,v))}cmp(n){return n.type!==this.type?this.type-n.type:L(this.key,this.value,n.key,n.value)}equals(n){return n.type===this.type?this.key===n.key&&this.value===n.value:!1}substituteConstants(){return this}evaluate(n){return typeof this.value=="string"?!1:parseFloat(n.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(n){return n.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=g.create(this.key,this.value,this)),this.negated}}e.ContextKeyGreaterEqualsExpr=f;class g{constructor(n,p,v){this.key=n,this.value=p,this.negated=v,this.type=14}static create(n,p,v=null){return r(p,K=>new g(n,K,v))}cmp(n){return n.type!==this.type?this.type-n.type:L(this.key,this.value,n.key,n.value)}equals(n){return n.type===this.type?this.key===n.key&&this.value===n.value:!1}substituteConstants(){return this}evaluate(n){return typeof this.value=="string"?!1:parseFloat(n.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(n){return n.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=f.create(this.key,this.value,this)),this.negated}}e.ContextKeySmallerExpr=g;class C{constructor(n,p,v){this.key=n,this.value=p,this.negated=v,this.type=15}static create(n,p,v=null){return r(p,K=>new C(n,K,v))}cmp(n){return n.type!==this.type?this.type-n.type:L(this.key,this.value,n.key,n.value)}equals(n){return n.type===this.type?this.key===n.key&&this.value===n.value:!1}substituteConstants(){return this}evaluate(n){return typeof this.value=="string"?!1:parseFloat(n.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(n){return n.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=u.create(this.key,this.value,this)),this.negated}}e.ContextKeySmallerEqualsExpr=C;class I{constructor(n,p){this.key=n,this.regexp=p,this.type=7,this.negated=null}static create(n,p){return new I(n,p)}cmp(n){if(n.type!==this.type)return this.type-n.type;if(this.key<n.key)return-1;if(this.key>n.key)return 1;const p=this.regexp?this.regexp.source:"",v=n.regexp?n.regexp.source:"";return p<v?-1:p>v?1:0}equals(n){if(n.type===this.type){const p=this.regexp?this.regexp.source:"",v=n.regexp?n.regexp.source:"";return this.key===n.key&&p===v}return!1}substituteConstants(){return this}evaluate(n){let p=n.getValue(this.key);return this.regexp?this.regexp.test(p):!1}serialize(){const n=this.regexp?`/${this.regexp.source}/${this.regexp.ignoreCase?"i":""}`:"/invalid/";return`${this.key} =~ ${n}`}keys(){return[this.key]}map(n){return n.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=M.create(this)),this.negated}}e.ContextKeyRegexExpr=I;class M{constructor(n){this._actual=n,this.type=8}static create(n){return new M(n)}cmp(n){return n.type!==this.type?this.type-n.type:this._actual.cmp(n._actual)}equals(n){return n.type===this.type?this._actual.equals(n._actual):!1}substituteConstants(){return this}evaluate(n){return!this._actual.evaluate(n)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}map(n){return new M(this._actual.map(n))}negate(){return this._actual}}e.ContextKeyNotRegexExpr=M;function a(P){let n=null;for(let p=0,v=P.length;p<v;p++){const K=P[p].substituteConstants();if(P[p]!==K&&n===null){n=[];for(let X=0;X<p;X++)n[X]=P[X]}n!==null&&(n[p]=K)}return n===null?P:n}class i{constructor(n,p){this.expr=n,this.negated=p,this.type=6}static create(n,p){return i._normalizeArr(n,p)}cmp(n){if(n.type!==this.type)return this.type-n.type;if(this.expr.length<n.expr.length)return-1;if(this.expr.length>n.expr.length)return 1;for(let p=0,v=this.expr.length;p<v;p++){const K=S(this.expr[p],n.expr[p]);if(K!==0)return K}return 0}equals(n){if(n.type===this.type){if(this.expr.length!==n.expr.length)return!1;for(let p=0,v=this.expr.length;p<v;p++)if(!this.expr[p].equals(n.expr[p]))return!1;return!0}return!1}substituteConstants(){const n=a(this.expr);return n===this.expr?this:i.create(n,this.negated)}evaluate(n){for(let p=0,v=this.expr.length;p<v;p++)if(!this.expr[p].evaluate(n))return!1;return!0}static _normalizeArr(n,p){const v=[];let K=!1;for(const X of n)if(!!X){if(X.type===1){K=!0;continue}if(X.type===0)return T.INSTANCE;if(X.type===6){v.push(...X.expr);continue}v.push(X)}if(v.length===0&&K)return _.INSTANCE;if(v.length!==0){if(v.length===1)return v[0];v.sort(S);for(let X=1;X<v.length;X++)v[X-1].equals(v[X])&&(v.splice(X,1),X--);if(v.length===1)return v[0];for(;v.length>1;){const X=v[v.length-1];if(X.type!==9)break;v.pop();const W=v.pop(),j=v.length===0,$=h.create(X.expr.map(Y=>i.create([Y,W],null)),null,j);$&&(v.push($),v.sort(S))}return v.length===1?v[0]:new i(v,p)}}serialize(){return this.expr.map(n=>n.serialize()).join(" && ")}keys(){const n=[];for(let p of this.expr)n.push(...p.keys());return n}map(n){return new i(this.expr.map(p=>p.map(n)),null)}negate(){if(!this.negated){const n=[];for(let p of this.expr)n.push(p.negate());this.negated=h.create(n,this,!0)}return this.negated}}class h{constructor(n,p){this.expr=n,this.negated=p,this.type=9}static create(n,p,v){return h._normalizeArr(n,p,v)}cmp(n){if(n.type!==this.type)return this.type-n.type;if(this.expr.length<n.expr.length)return-1;if(this.expr.length>n.expr.length)return 1;for(let p=0,v=this.expr.length;p<v;p++){const K=S(this.expr[p],n.expr[p]);if(K!==0)return K}return 0}equals(n){if(n.type===this.type){if(this.expr.length!==n.expr.length)return!1;for(let p=0,v=this.expr.length;p<v;p++)if(!this.expr[p].equals(n.expr[p]))return!1;return!0}return!1}substituteConstants(){const n=a(this.expr);return n===this.expr?this:h.create(n,this.negated,!1)}evaluate(n){for(let p=0,v=this.expr.length;p<v;p++)if(this.expr[p].evaluate(n))return!0;return!1}static _normalizeArr(n,p,v){let K=[],X=!1;if(n){for(let W=0,j=n.length;W<j;W++){const $=n[W];if(!!$){if($.type===0){X=!0;continue}if($.type===1)return _.INSTANCE;if($.type===9){K=K.concat($.expr);continue}K.push($)}}if(K.length===0&&X)return T.INSTANCE;K.sort(S)}if(K.length!==0){if(K.length===1)return K[0];for(let W=1;W<K.length;W++)K[W-1].equals(K[W])&&(K.splice(W,1),W--);if(K.length===1)return K[0];if(v){for(let W=0;W<K.length;W++)for(let j=W+1;j<K.length;j++)U(K[W],K[j])&&(K.splice(j,1),j--);if(K.length===1)return K[0]}return new h(K,p)}}serialize(){return this.expr.map(n=>n.serialize()).join(" || ")}keys(){const n=[];for(let p of this.expr)n.push(...p.keys());return n}map(n){return new h(this.expr.map(p=>p.map(n)),null)}negate(){if(!this.negated){let n=[];for(let p of this.expr)n.push(p.negate());for(;n.length>1;){const p=n.shift(),v=n.shift(),K=[];for(const W of z(p))for(const j of z(v))K.push(i.create([W,j],null));const X=n.length===0;n.unshift(h.create(K,null,X))}this.negated=n[0]}return this.negated}}class l extends N{constructor(n,p,v){super(n,null);this._defaultValue=p,typeof v=="object"?l._info.push({...v,key:n}):v!==!0&&l._info.push({key:n,description:v,type:p!=null?typeof p:void 0})}static all(){return l._info.values()}bindTo(n){return n.createKey(this.key,this._defaultValue)}getValue(n){return n.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(n){return b.create(this.key,n)}notEqualsTo(n){return t.create(this.key,n)}}e.RawContextKey=l,l._info=[],e.IContextKeyService=(0,D.createDecorator)("contextKeyService"),e.SET_CONTEXT_COMMAND_ID="setContext";function d(P,n){return P<n?-1:P>n?1:0}function L(P,n,p,v){return P<p?-1:P>p?1:n<v?-1:n>v?1:0}function U(P,n){if(n.type===6&&P.type!==9&&P.type!==6){for(const K of n.expr)if(P.equals(K))return!0}const p=P.negate(),v=z(p).concat(z(n));v.sort(S);for(let K=0;K<v.length;K++){const W=v[K].negate();for(let j=K+1;j<v.length;j++){const $=v[j];if(W.equals($))return!0}}return!1}e.implies=U;function z(P){return P.type===9?P.expr:[P]}}),define(ne[29],ie([0,1,19,35,12,8,4,3,28]),function(Z,e,O,F,D,E,q,k,A){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NotebookWorkingCopyTypeIdentifier=e.CellStatusbarAlignment=e.NotebookSetting=e.notebookDocumentFilterMatch=e.isDocumentExcludePattern=e.NotebookEditorPriority=e.NOTEBOOK_EDITOR_CURSOR_BOUNDARY=e.diff=e.MimeTypeDisplayOrder=e.CellUri=e.CellEditType=e.SelectionStateType=e.NotebookCellsChangeType=e.RendererMessagingSpec=e.NotebookRendererMatch=e.NotebookCellExecutionState=e.NotebookRunState=e.RENDERER_NOT_AVAILABLE=e.RENDERER_EQUIVALENT_EXTENSIONS=e.ACCESSIBLE_NOTEBOOK_DISPLAY_ORDER=e.NOTEBOOK_DISPLAY_ORDER=e.CellKind=e.NOTEBOOK_DIFF_EDITOR_ID=e.NOTEBOOK_EDITOR_ID=void 0,e.NOTEBOOK_EDITOR_ID="workbench.editor.notebook",e.NOTEBOOK_DIFF_EDITOR_ID="workbench.editor.notebookTextDiffEditor";var w;(function(a){a[a.Markup=1]="Markup",a[a.Code=2]="Code"})(w=e.CellKind||(e.CellKind={})),e.NOTEBOOK_DISPLAY_ORDER=["application/json","application/javascript","text/html","image/svg+xml",D.Mimes.latex,D.Mimes.markdown,"image/png","image/jpeg",D.Mimes.text],e.ACCESSIBLE_NOTEBOOK_DISPLAY_ORDER=[D.Mimes.latex,D.Mimes.markdown,"application/json",D.Mimes.text,"text/html","image/svg+xml","image/png","image/jpeg"],e.RENDERER_EQUIVALENT_EXTENSIONS=new Map([["ms-toolsai.jupyter",new Set(["jupyter-notebook","interactive"])],["ms-toolsai.jupyter-renderers",new Set(["jupyter-notebook","interactive"])]]),e.RENDERER_NOT_AVAILABLE="_notAvailable";var S;(function(a){a[a.Running=1]="Running",a[a.Idle=2]="Idle"})(S=e.NotebookRunState||(e.NotebookRunState={}));var T;(function(a){a[a.Unconfirmed=1]="Unconfirmed",a[a.Pending=2]="Pending",a[a.Executing=3]="Executing"})(T=e.NotebookCellExecutionState||(e.NotebookCellExecutionState={}));var _;(function(a){a[a.WithHardKernelDependency=0]="WithHardKernelDependency",a[a.WithOptionalKernelDependency=1]="WithOptionalKernelDependency",a[a.Pure=2]="Pure",a[a.Never=3]="Never"})(_=e.NotebookRendererMatch||(e.NotebookRendererMatch={}));var N;(function(a){a.Always="always",a.Never="never",a.Optional="optional"})(N=e.RendererMessagingSpec||(e.RendererMessagingSpec={}));var b;(function(a){a[a.ModelChange=1]="ModelChange",a[a.Move=2]="Move",a[a.ChangeCellLanguage=5]="ChangeCellLanguage",a[a.Initialize=6]="Initialize",a[a.ChangeCellMetadata=7]="ChangeCellMetadata",a[a.Output=8]="Output",a[a.OutputItem=9]="OutputItem",a[a.ChangeCellContent=10]="ChangeCellContent",a[a.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",a[a.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",a[a.ChangeCellMime=13]="ChangeCellMime",a[a.Unknown=100]="Unknown"})(b=e.NotebookCellsChangeType||(e.NotebookCellsChangeType={}));var c;(function(a){a[a.Handle=0]="Handle",a[a.Index=1]="Index"})(c=e.SelectionStateType||(e.SelectionStateType={}));var o;(function(a){a[a.Replace=1]="Replace",a[a.Output=2]="Output",a[a.Metadata=3]="Metadata",a[a.CellLanguage=4]="CellLanguage",a[a.DocumentMetadata=5]="DocumentMetadata",a[a.Move=6]="Move",a[a.OutputItems=7]="OutputItems",a[a.PartialMetadata=8]="PartialMetadata",a[a.PartialInternalMetadata=9]="PartialInternalMetadata"})(o=e.CellEditType||(e.CellEditType={}));var t;(function(a){a.scheme=E.Schemas.vscodeNotebookCell;const i=/^ch(\d{7,})/;function h(P,n){return P.with({scheme:a.scheme,fragment:`ch${n.toString().padStart(7,"0")}${P.scheme!==E.Schemas.file?P.scheme:""}`})}a.generate=h;function l(P){if(P.scheme!==a.scheme)return;const n=i.exec(P.fragment);return n?{handle:Number(n[1]),notebook:P.with({scheme:P.fragment.substring(n[0].length)||E.Schemas.file,fragment:null})}:void 0}a.parse=l;function d(P,n){return P.with({scheme:E.Schemas.vscodeNotebookCellOutput,fragment:`op${n??""},${P.scheme!==E.Schemas.file?P.scheme:""}`})}a.generateCellOutputUri=d;function L(P){if(P.scheme!==E.Schemas.vscodeNotebookCellOutput)return;const n=/^op([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})?\,(.*)$/i.exec(P.fragment);if(!n)return;const p=n[1]&&n[1]!==""?n[1]:void 0,v=n[2];return{outputId:p,notebook:P.with({scheme:v||E.Schemas.file,fragment:null})}}a.parseCellOutputUri=L;function U(P,n,p){return P.with({scheme:p,fragment:`ch${n.toString().padStart(7,"0")}${P.scheme!==E.Schemas.file?P.scheme:""}`})}a.generateCellUri=U;function z(P,n){if(P.scheme!==n)return;const p=i.exec(P.fragment);return p?{handle:Number(p[1]),notebook:P.with({scheme:P.fragment.substring(p[0].length)||E.Schemas.file,fragment:null})}:void 0}a.parseCellUri=z})(t=e.CellUri||(e.CellUri={}));const s=a=>k.isWindows?a.replace(/\//g,"\\"):a;class r{constructor(i=[],h=e.NOTEBOOK_DISPLAY_ORDER){this.defaultOrder=h,this.order=[...new Set(i)].map(l=>({pattern:l,matches:O.parse(s(l))}))}sort(i){const h=new Map(F.Iterable.map(i,d=>[d,s(d)]));let l=[];for(const{matches:d}of this.order)for(const[L,U]of h)if(d(U)){l.push(L),h.delete(L);break}return h.size&&(l=l.concat([...h.keys()].sort((d,L)=>this.defaultOrder.indexOf(d)-this.defaultOrder.indexOf(L)))),l}prioritize(i,h){const l=this.findIndex(i);if(l===-1){this.order.unshift({pattern:i,matches:O.parse(s(i))});return}const d=new Set(h.map(U=>this.findIndex(U,l)));d.delete(-1);const L=Array.from(d).sort();this.order.splice(l+1,0,...L.map(U=>this.order[U]));for(let U=L.length-1;U>=0;U--)this.order.splice(L[U],1)}toArray(){return this.order.map(i=>i.pattern)}findIndex(i,h=this.order.length){const l=s(i);for(let d=0;d<h;d++)if(this.order[d].matches(l))return d;return-1}}e.MimeTypeDisplayOrder=r;function u(a,i,h,l=(d,L)=>d===L){const d=[];function L(P,n,p){if(n===0&&p.length===0)return;const v=d[d.length-1];v&&v.start+v.deleteCount===P?(v.deleteCount+=n,v.toInsert.push(...p)):d.push({start:P,deleteCount:n,toInsert:p})}let U=0,z=0;for(;;){if(U===a.length){L(U,0,i.slice(z));break}if(z===i.length){L(U,a.length-U,[]);break}const P=a[U],n=i[z];if(l(P,n)){U+=1,z+=1;continue}h(n)?(L(U,1,[]),U+=1):(L(U,0,[n]),z+=1)}return d}e.diff=u,e.NOTEBOOK_EDITOR_CURSOR_BOUNDARY=new A.RawContextKey("notebookEditorCursorAtBoundary","none");var f;(function(a){a.default="default",a.option="option"})(f=e.NotebookEditorPriority||(e.NotebookEditorPriority={}));function g(a){const i=a;return!!((typeof i.include=="string"||O.isRelativePattern(i.include))&&(typeof i.exclude=="string"||O.isRelativePattern(i.exclude)))}e.isDocumentExcludePattern=g;function C(a,i,h){if(Array.isArray(a.viewType)&&a.viewType.indexOf(i)>=0||a.viewType===i)return!0;if(a.filenamePattern){const l=g(a.filenamePattern)?a.filenamePattern.include:a.filenamePattern,d=g(a.filenamePattern)?a.filenamePattern.exclude:void 0;if(O.match(l,(0,q.basename)(h.fsPath).toLowerCase()))return!(d&&O.match(d,(0,q.basename)(h.fsPath).toLowerCase()))}return!1}e.notebookDocumentFilterMatch=C,e.NotebookSetting={displayOrder:"notebook.displayOrder",cellToolbarLocation:"notebook.cellToolbarLocation",cellToolbarVisibility:"notebook.cellToolbarVisibility",showCellStatusBar:"notebook.showCellStatusBar",textDiffEditorPreview:"notebook.diff.enablePreview",experimentalInsertToolbarAlignment:"notebook.experimental.insertToolbarAlignment",compactView:"notebook.compactView",focusIndicator:"notebook.cellFocusIndicator",insertToolbarLocation:"notebook.insertToolbarLocation",globalToolbar:"notebook.globalToolbar",undoRedoPerCell:"notebook.undoRedoPerCell",consolidatedOutputButton:"notebook.consolidatedOutputButton",showFoldingControls:"notebook.showFoldingControls",dragAndDropEnabled:"notebook.dragAndDropEnabled",cellEditorOptionsCustomizations:"notebook.editorOptionsCustomizations",consolidatedRunButton:"notebook.consolidatedRunButton",openGettingStarted:"notebook.experimental.openGettingStarted",textOutputLineLimit:"notebook.output.textLineLimit",globalToolbarShowLabel:"notebook.globalToolbarShowLabel",markupFontSize:"notebook.markup.fontSize",interactiveWindowCollapseCodeCells:"interactiveWindow.collapseCellInputCode",outputLineHeight:"notebook.outputLineHeight",outputFontSize:"notebook.outputFontSize",outputFontFamily:"notebook.outputFontFamily"};var I;(function(a){a[a.Left=1]="Left",a[a.Right=2]="Right"})(I=e.CellStatusbarAlignment||(e.CellStatusbarAlignment={}));class M{static create(i){return`${M._prefix}${i}`}static parse(i){if(i.startsWith(M._prefix))return i.substring(M._prefix.length)}}e.NotebookWorkingCopyTypeIdentifier=M,M._prefix="notebook/"}),define(ne[36],ie([0,1,37,38,9,26,29,11]),function(Z,e,O,F,D,E,q,k){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=e.NotebookEditorSimpleWorker=e.CellSequence=void 0;function A(b){let c=(0,F.numberHash)(104579,0);for(let o=0;o<b.buffer.length;o++)c=(0,F.doHash)(b.buffer[o],c);return c}class w{constructor(c,o,t,s,r,u,f){this.handle=c,this._source=o,this.language=t,this.cellKind=s,this.outputs=r,this.metadata=u,this.internalMetadata=f,this._primaryKey=null,this._hash=null}get textBuffer(){if(this._textBuffer)return this._textBuffer;const c=new E.PieceTreeTextBufferBuilder;c.acceptChunk(Array.isArray(this._source)?this._source.join(`
`):this._source);const o=c.finish(!0);return this._textBuffer=o.create(1).textBuffer,this._textBuffer}primaryKey(){return this._primaryKey===void 0&&(this._primaryKey=(0,F.hash)(this.getValue())),this._primaryKey}getFullModelRange(){const c=this.textBuffer.getLineCount();return new k.Range(1,1,c,this.textBuffer.getLineLength(c)+1)}getValue(){const c=this.getFullModelRange();return this.textBuffer.getEOL()===`
`?this.textBuffer.getValueInRange(c,1):this.textBuffer.getValueInRange(c,2)}getComparisonValue(){return this._primaryKey!==null?this._primaryKey:(this._hash=(0,F.hash)([(0,F.hash)(this.language),(0,F.hash)(this.getValue()),this.metadata,this.internalMetadata,this.outputs.map(c=>({outputs:c.outputs.map(o=>({mime:o.mime,data:A(o.data)})),metadata:c.metadata}))]),this._hash)}getHashValue(){return this._hash!==null?this._hash:(this._hash=(0,F.hash)([(0,F.hash)(this.getValue()),this.language,this.metadata,this.internalMetadata]),this._hash)}}class S{constructor(c,o,t){this.uri=c,this.cells=o,this.metadata=t}acceptModelChanged(c){c.rawEvents.forEach(o=>{if(o.kind===q.NotebookCellsChangeType.ModelChange)this._spliceNotebookCells(o.changes);else if(o.kind===q.NotebookCellsChangeType.Move){const t=this.cells.splice(o.index,1);this.cells.splice(o.newIdx,0,...t)}else if(o.kind===q.NotebookCellsChangeType.Output){const t=this.cells[o.index];t.outputs=o.outputs}else if(o.kind===q.NotebookCellsChangeType.ChangeCellLanguage){const t=this.cells[o.index];t.language=o.language}else if(o.kind===q.NotebookCellsChangeType.ChangeCellMetadata){const t=this.cells[o.index];t.metadata=o.metadata}else if(o.kind===q.NotebookCellsChangeType.ChangeCellInternalMetadata){const t=this.cells[o.index];t.internalMetadata=o.internalMetadata}})}_spliceNotebookCells(c){c.reverse().forEach(o=>{const s=o[2].map(r=>new w(r.handle,r.source,r.language,r.cellKind,r.outputs,r.metadata));this.cells.splice(o[0],o[1],...s)})}}class T{constructor(c){this.textModel=c}getElements(){const c=new Int32Array(this.textModel.cells.length);for(let o=0;o<this.textModel.cells.length;o++)c[o]=this.textModel.cells[o].getComparisonValue();return c}getCellHash(c){const o=Array.isArray(c.source)?c.source.join(`
`):c.source;return(0,F.hash)([(0,F.hash)(o),c.metadata])}}e.CellSequence=T;class _{constructor(){this._models=Object.create(null)}dispose(){}acceptNewModel(c,o){this._models[c]=new S(D.URI.parse(c),o.cells.map(t=>new w(t.handle,t.source,t.language,t.cellKind,t.outputs,t.metadata)),o.metadata)}acceptModelChanged(c,o){const t=this._models[c];t&&t.acceptModelChanged(o)}acceptRemovedModel(c){!this._models[c]||delete this._models[c]}computeDiff(c,o){const t=this._getModel(c),s=this._getModel(o);return{cellsDiff:new O.LcsDiff(new T(t),new T(s)).ComputeDiff(!1)}}_getModel(c){return this._models[c]}}e.NotebookEditorSimpleWorker=_;function N(b){return new _}e.create=N})}).call(this);

//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/35e32acbb5092c636f38673cc6a41300bbe8f83d/core/vs/workbench/contrib/notebook/common/services/notebookSimpleWorker.js.map
